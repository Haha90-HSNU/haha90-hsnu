var MyJS=MyJS||{};!function(){var M;function o(){if(1===M.gameMD);else if(2===M.gameMD){if(M.isDraging||M.isDirty){M.isDirty=!0;var e=M.myFlash.theTeach.question.lines,a=M.myFlash.theTeach.question.obj,t=M.myFlash.theTeach.question.image;t.obj.textDragMe.visible=!1,t.mm.visible=!1;var i=-a.x,n=150*(1===M.lenMD||4===M.lenMD?1:-1),l=1/(1/n-1/i);t.x=l*(1===M.lenMD||2===M.lenMD?1:-1),t.scaleX=t.scaleY=-l/i,t.obj.mask=l<0?t.mm.shape:null;var s,o=Math.atan2(M.objH,Math.abs(n)),m=Math.atan2(M.objH,i);e.line1a.x=a.x,e.line1a.y=-M.objH,e.line1a.mm.shape.x=-1e3+i,e.line1b.x=0,e.line1b.y=-M.objH,e.line1b.rotation=180*o/Math.PI*(2===M.lenMD||4===M.lenMD?-1:1)+180*(1===M.lenMD||2===M.lenMD?0:1),(1500<(s=l/Math.cos(o))||s<0)&&(s=1500),e.line1b.mm.shape.x=-1e3+s,e.line2a.x=a.x,e.line2a.y=-M.objH,e.line2a.rotation=180*m/Math.PI,(1500<(s=i/Math.cos(m))||s<0)&&(s=1500),e.line2a.mm.shape.x=-1e3+s,e.line2b.x=0,e.line2b.y=0,e.line2b.rotation=180*m/Math.PI*(3===M.lenMD||4===M.lenMD?-1:1)+180*(1===M.lenMD||2===M.lenMD?0:1),(1500<(s=l/Math.cos(m))||s<0)&&(s=1500),e.line2b.mm.shape.x=-1e3+s,e.line1d.visible=l<0,e.line1d.x=0,e.line1d.y=-M.objH,e.line1d.rotation=e.line1b.rotation+180,(1500<(s=-l/Math.cos(o))||s<0)&&(s=1500),e.line1d.mm.shape.x=-1e3+s,e.line2d.visible=l<0,e.line2d.x=0,e.line2d.y=0,e.line2d.rotation=e.line2b.rotation+180,(1500<(s=-l/Math.cos(m))||s<0)&&(s=1500),e.line2d.mm.shape.x=-1e3+s;var h=M.myFlash.theTeach.stateText;h.tp00.gotoAndStop(0),h.tq00.gotoAndStop(1),h.tp01.gotoAndStop(0),h.tq01.gotoAndStop(1===M.lenMD&&l<0||2===M.lenMD||4===M.lenMD&&0<l?0:1),i<150?h.tp02.gotoAndStop(0):i<300?h.tp02.gotoAndStop(1):h.tp02.gotoAndStop(2),(1===M.lenMD||4===M.lenMD)&&l<0?h.tq02.gotoAndStop(3):Math.abs(l)<150?h.tq02.gotoAndStop(0):Math.abs(l)<300?h.tq02.gotoAndStop(1):h.tq02.gotoAndStop(2),(1===M.lenMD||4===M.lenMD)&&l<0?h.t03.gotoAndStop(2):2===M.lenMD||3===M.lenMD?h.t03.gotoAndStop(3):l/i<1?h.t03.gotoAndStop(0):1<l/i&&h.t03.gotoAndStop(1);var r=M.myFlash.theTeach.question.boxs;r.scaleX=4===M.lenMD||3===M.lenMD?-1:1;for(var u=1;u<=4;u++)for(var d=1;d<=4;d++)r["b"+String(u)+String(d)].visible=!1;u=0<l?Math.min(Math.floor(l/150)+1,3):4;if(l/i<-1)d=1;else if(l/i<-0)d=2;else if(l/i<1)d=3;else if(1<l/i)d=4;r["b"+String(u)+String(d)].visible=!0}}else if(3===M.gameMD);else if(4===M.gameMD){M.timerNow=new Date,M.needNewQuestion&&function(){M.needNewQuestion=!1,M.isDirty=!0;var e=M.myFlash.theGame.questionGame.lines,a=M.myFlash.theGame.questionGame.obj,t=M.myFlash.theGame.questionGame.image;a.textDragMe.visible=!1,t.obj.textDragMe.visible=!1,t.mm.visible=!1;var i=M.lenMD;if(1===M.levelNow)M.lenMD=1;else if(2===M.levelNow)1===M.lenMD?M.lenMD=Math.random()<.5?1:2:M.lenMD=Math.random()<.75?1:2;else if(3===M.levelNow)M.lenMD=4;else if(4===M.levelNow)4===M.lenMD?M.lenMD=Math.random()<.5?4:3:M.lenMD=Math.random()<.75?4:3;else if(4<M.levelNow){var n=Math.random();1===M.lenMD?M.lenMD=n<.2?1:n<.4?2:n<.6?3:4:4===M.lenMD?M.lenMD=n<.2?4:n<.4?2:n<.6?3:1:M.lenMD=n<.1?2:n<.2?3:n<.6?4:1}M.myFlash.theGame.questionGame.lens.gotoAndStop(M.lenMD-1),M.myFlash.theGame.lensText.gotoAndStop(M.lenMD-1);var l=-a.x;if(1===M.lenMD||4===M.lenMD)for(var s=!1;!s;){var n=Math.random();if(n<1/3)var o=20+110*Math.random();else if(n<2/3)var o=170+120*Math.random();else var o=310+130*Math.random();s=!(Math.floor(l/150)===Math.floor(o/150)&&i===M.lenMD)}else o=450*Math.random();a.x=-o;var m=150*(1===M.lenMD||4===M.lenMD?1:-1),h=1/(1/m-1/o);t.x=h*(1===M.lenMD||2===M.lenMD?1:-1),t.scaleX=t.scaleY=-h/o,t.obj.mask=h<0?t.mm.shape:null;var r,u=Math.atan2(M.objH,Math.abs(m)),d=Math.atan2(M.objH,o);e.line1a.x=a.x,e.line1a.y=-M.objH,e.line1a.mm.shape.x=-1e3+o,e.line1b.x=0,e.line1b.y=-M.objH,e.line1b.rotation=180*u/Math.PI*(2===M.lenMD||4===M.lenMD?-1:1)+180*(1===M.lenMD||2===M.lenMD?0:1),(1500<(r=h/Math.cos(u))||r<0)&&(r=1500);e.line1b.mm.shape.x=-1e3+r,e.line2a.x=a.x,e.line2a.y=-M.objH,e.line2a.rotation=180*d/Math.PI,(1500<(r=o/Math.cos(d))||r<0)&&(r=1500);e.line2a.mm.shape.x=-1e3+r,e.line2b.x=0,e.line2b.y=0,e.line2b.rotation=180*d/Math.PI*(3===M.lenMD||4===M.lenMD?-1:1)+180*(1===M.lenMD||2===M.lenMD?0:1),(1500<(r=h/Math.cos(d))||r<0)&&(r=1500);e.line2b.mm.shape.x=-1e3+r,e.line1d.visible=h<0,e.line1d.x=0,e.line1d.y=-M.objH,e.line1d.rotation=e.line1b.rotation+180,(1500<(r=-h/Math.cos(u))||r<0)&&(r=1500);e.line1d.mm.shape.x=-1e3+r,e.line2d.visible=h<0,e.line2d.x=0,e.line2d.y=0,e.line2d.rotation=e.line2b.rotation+180,(1500<(r=-h/Math.cos(d))||r<0)&&(r=1500);if(e.line2d.mm.shape.x=-1e3+r,M.myFlash.theGame.questionGame.allBtnAnser.scaleX=M.myFlash.theGame.questionGame.boxs.scaleX=4===M.lenMD||3===M.lenMD?-1:1,6<=M.levelNow){var c=M.myFlash.theGame.questionGame.scaleX,b=M.myFlash.theGame.questionGame.scaleY,n=Math.random();n<.3?(M.myFlash.theGame.questionGame.scaleX=-1.2,M.myFlash.theGame.questionGame.scaleY=-1.2):n<.6?(M.myFlash.theGame.questionGame.scaleX=-1.2,M.myFlash.theGame.questionGame.scaleY=1.2):n<.9?(M.myFlash.theGame.questionGame.scaleX=1.2,M.myFlash.theGame.questionGame.scaleY=-1.2):(M.myFlash.theGame.questionGame.scaleX=1.2,M.myFlash.theGame.questionGame.scaleY=1.2),c===M.myFlash.theGame.questionGame.scaleX&&b===M.myFlash.theGame.questionGame.scaleY&&(Math.random()<.5?M.myFlash.theGame.questionGame.scaleX*=-1:M.myFlash.theGame.questionGame.scaleY*=-1)}else M.myFlash.theGame.questionGame.scaleX=1.2,M.myFlash.theGame.questionGame.scaleY=1.2;var v=0<h?Math.min(Math.floor(h/150)+1,3):4;if(h/o<-1)var y=1;else if(h/o<-0)var y=2;else if(h/o<1)var y=3;else if(1<h/o)var y=4;M.anserNow="b"+String(v)+String(y),e.visible=!1,t.visible=!1}(),M.myFlash.theGame.ooxx.visible=!1,M.myFlash.theGame.questionGame.lines.visible=!1,M.myFlash.theGame.questionGame.image.visible=!1;var c=M.timerNow.getTime()-M.timerOld.getTime();Math.round(M.timeLimit-c/1e3)!==M.myFlash.theGame.theInfoPanel.infoTimer.currentFrame&&(M.isDirty=!0,M.myFlash.theGame.theInfoPanel.infoTimer.gotoAndStop(Math.round(M.timeLimit-c/1e3)),M.isSound&&400<c&&(M.soundBeepShort.currentTime=0,M.soundBeepShort.play())),c>=1e3*M.timeLimit&&(M.gameMD=5,M.isDirty=!0,M.myFlash.theGame.ooxx.gotoAndStop(2),M.myFlash.theGame.questionGame.lines.visible=!1,M.myFlash.theGame.questionGame.image.visible=!1,M.myFlash.theGame.ooxx.visible=!0,M.needNewQuestion=!1,M.countXX++,D(M.textDigitsInfoXX,M.countXX),M.timerOld=new Date,M.timerNow=new Date,M.isSound&&M.soundXX.play())}else if(5===M.gameMD){if(M.timerNow=new Date,(c=M.timerNow.getTime()-M.timerOld.getTime())>1e3-60*M.levelNow){for(var b=1;b<=4;b++)for(var v=1;v<=4;v++){M.myFlash.theGame.questionGame.boxs["b"+String(b)+String(v)].visible=!1}M.isDirty=!0,M.countOO>=M.countOOMax&&10!==M.levelNow?y(M.levelNow+1):M.countXX>=M.countXXMax?(M.gameMD=6,M.isDirty=!0,M.myFlash.theGameOver.visible=!0,M.myFlash.theGameOver.infoLevel.gotoAndStop(M.levelNow-1),M.myFlash.theGameOver.textCountOO.visible=10===M.levelNow,D(M.textDigitsGameover,M.countOO),M.myFlash.theGameOver.textCountOO.textQQ.x=27*String(M.countOO).length+8,M.isSound&&M.soundGameover.play()):(M.gameMD=4,M.timerNow=new Date,M.timerOld=new Date)}}(M.isDirty||0<M.pointerTweening)&&(M.stage.update(),(MyJS.browserInfo.isMobile||4!==M.gameMD)&&(M.isDirty=!1),M.pointerTweening--,log("update"))}function m(e){M.gameMD=1,M.myFlash.theWelcome.visible=!0,M.myFlash.theTeach.visible=!1,M.myFlash.theGameOver.visible=!1,M.myFlash.theGame.visible=!1,M.isDirty=!0,M.isSound&&e&&(M.soundIntro.currentTime=0,M.soundIntro.play())}function y(e){M.gameMD=3,M.isDirty=!0,1===e?(M.timeLimit=12,M.countOOMax=8):2===e?(M.timeLimit=12,M.countOOMax=8):3===e?(M.timeLimit=12,M.countOOMax=8):4===e?(M.timeLimit=12,M.countOOMax=8):5===e?(M.timeLimit=10,M.countOOMax=8):6===e?(M.timeLimit=8,M.countOOMax=6):7===e?(M.timeLimit=6,M.countOOMax=6):8===e?(M.timeLimit=4,M.countOOMax=6):9===e?(M.timeLimit=2,M.countOOMax=6):10===e?(M.timeLimit=1,M.countOOMax=-1):log("_level錯誤!!!!"),M.levelNow=e,M.countOO=0,M.countXX=0,M.countXXMax=3,D(M.textDigitsInfoOO,0),D(M.textDigitsInfoXX,0),M.myFlash.theGame.theLevelUp.visible=!0,M.myFlash.theGame.questionGame.visible=!1,M.myFlash.theGame.theInfoPanel.infoLevel.gotoAndStop(e-1),M.myFlash.theGame.theInfoPanel.infoTimer.gotoAndStop(M.timeLimit),M.myFlash.theGame.theLevelUp.gotoAndStop(e-1),M.isSound&&M.soundLevelup.play()}function h(e){if(4===M.gameMD){M.gameMD=5,M.isDirty=!0;var a=e.target.name,t=M.anserNow===a;M.myFlash.theGame.ooxx.gotoAndStop(t?0:1),M.myFlash.theGame.questionGame.lines.visible=t,M.myFlash.theGame.questionGame.image.visible=t,M.myFlash.theGame.ooxx.visible=!0,M.needNewQuestion=t;for(var i=1;i<=4;i++)for(var n=1;n<=4;n++){var l=M.myFlash.theGame.questionGame.boxs["b"+String(i)+String(n)];l.visible=l.name===a}t?(M.countOO++,10!==M.levelNow&&(M.countXX=0,D(M.textDigitsInfoXX,M.countXX)),D(M.textDigitsInfoOO,M.countOO),M.isSound&&M.soundOO.play()):(M.countXX++,D(M.textDigitsInfoXX,M.countXX),M.isSound&&M.soundXX.play()),M.timerOld=new Date,M.timerNow=new Date}}function r(e){if(e)var a=parseInt(e.target.parent.name.charAt(5));a=a||M.lenMD;for(var t=0;t<4;t++)M.rbGTeach[t].rbDot.visible=t===a-1;M.lenMD=a,M.myFlash.theTeach.question.lens.gotoAndStop(M.lenMD-1),M.isDirty=!0,M.isSound&&M.soundClick.play()}function u(e){var a=0,t=0;if("mousedown"===e.type?(a=e.stageX,t=e.stageY):"touchstart"===e.type&&(a=e.stageX,t=e.stageY),4!==M.gameMD){var i=M.myFlash.mPointer;i.visible=!0,i.x=a,i.y=t,i.alpha=1,i.scaleX=i.scaleY=.5,createjs.Tween.get(i).to({scaleX:3,scaleY:3,alpha:0},300).call(n),M.pointerTweening=1e12}}function n(){M.pointerTweening=10,M.myFlash.mPointer.visible=!1}function d(e){M.isSound=!M.isSound,M.myFlash.btnSound.gotoAndStop(M.isSound?0:1),M.isDirty=!0}function D(e,a){for(var t=Math.round(a),i=String(t),n=e.length,l=0;l<n;l++){var s=e[l];s.visible=l<i.length;var o=i.charAt(l)||"0";s.gotoAndStop(parseInt(o))}M.isDirty=!0}function c(e){MyJS.myFullScreen()}MyJS.TheWorld=function(){M=this,(theWorld=M).objH=120,M.gameMD=1,M.lenMD=1,M.ff=150,M.isDraging=!1,M.soundOO=new Audio("allData/js/sound/OO.mp3"),M.soundXX=new Audio("allData/js/sound/XX.mp3"),M.soundClick=new Audio("allData/js/sound/click.mp3"),M.soundBeepShort=new Audio("allData/js/sound/BeepShort.mp3"),M.soundLevelup=new Audio("allData/js/sound/levelup.mp3"),M.soundGameover=new Audio("allData/js/sound/gameover.mp3"),M.soundIntro=new Audio("allData/js/sound/intro.mp3"),M.isSound=!0;var e=AdobeAn.getComposition("4156457732338E40B60DBDC1F35A7171").getLibrary();M.myFlash=new e.myFlash;var a=$("<canvas>").attr("width","1280px").attr("height","720px");$("#mainAnimation").append(a),M.stage=new createjs.Stage(a[0]),M.stage.addChild(M.myFlash),M.stage.enableMouseOver(60),createjs.Touch.enable(M.stage),M.stage.update(),M.myFlash.btnSound.addEventListener("click",d),M.myFlash.btnSound.gotoAndStop(M.isSound?0:1),M.isFullScreened=!1,M.myFlash.btnFullScreen.addEventListener("click",c),(t=M.myFlash.theTeach.question.lines).line1a.mm.visible=!1,t.line1a.line.mask=t.line1a.mm.shape,t.line1b.mm.visible=!1,t.line1b.line.mask=t.line1b.mm.shape,t.line1d.mm.visible=!1,t.line1d.line.mask=t.line1d.mm.shape,t.line2a.mm.visible=!1,t.line2a.line.mask=t.line2a.mm.shape,t.line2b.mm.visible=!1,t.line2b.line.mask=t.line2b.mm.shape,t.line2d.mm.visible=!1,t.line2d.line.mask=t.line2d.mm.shape;var t=M.myFlash.theTeach.controlLen;M.rbGTeach=[t.rbLen1,t.rbLen2,t.rbLen3,t.rbLen4],(t=M.myFlash.theGame.questionGame.lines).line1a.mm.visible=!1,t.line1a.line.mask=t.line1a.mm.shape,t.line1b.mm.visible=!1,t.line1b.line.mask=t.line1b.mm.shape,t.line1d.mm.visible=!1,t.line1d.line.mask=t.line1d.mm.shape,t.line2a.mm.visible=!1,t.line2a.line.mask=t.line2a.mm.shape,t.line2b.mm.visible=!1,t.line2b.line.mask=t.line2b.mm.shape,t.line2d.mm.visible=!1,t.line2d.line.mask=t.line2d.mm.shape,M.myFlash.theWelcome.btnTeach.on("click",function(e){M.gameMD=2,M.isDirty=!0,M.myFlash.theWelcome.visible=!1,M.myFlash.theTeach.visible=!0,M.myFlash.theGameOver.visible=!1,M.myFlash.theGame.visible=!1,M.isSound&&M.soundClick.play()}),M.myFlash.theWelcome.btnIntoGame.on("click",function(e){M.gameMD=3,M.myFlash.theWelcome.visible=!1,M.myFlash.theTeach.visible=!1,M.myFlash.theGameOver.visible=!1,M.myFlash.theGame.visible=!0,y(1),M.isSound&&M.soundClick.play()}),M.myFlash.theGame.theLevelUp.btnStartGame.on("click",function(e){M.gameMD=4,M.timerNow=new Date,M.timerOld=new Date,M.myFlash.theGame.theLevelUp.visible=!1,M.myFlash.theGame.questionGame.visible=!0,M.needNewQuestion=!0;for(var a=1;a<=4;a++)for(var t=1;t<=4;t++)M.myFlash.theGame.questionGame.boxs["b"+String(a)+String(t)].visible=!1;M.isSound&&M.soundClick.play()}),M.myFlash.theTeach.btnOK.on("click",function(e){M.gameMD=1,M.isDirty=!0,M.myFlash.theWelcome.visible=!0,M.myFlash.theTeach.visible=!1,M.myFlash.theGameOver.visible=!1,M.myFlash.theGame.visible=!1,M.isSound&&M.soundClick.play()}),M.myFlash.theTeach.question.btnS.on("mousedown",function(e){M.isDraging=!0,M.dX=e.stageX-M.myFlash.theTeach.question.obj.x}),M.myFlash.theTeach.question.btnS.on("pressmove",function(e){if(M.isDraging){var a=M.myFlash.theTeach.question.obj;a.x=e.stageX-M.dX,a.x<-560&&(a.x=-560),-30<a.x&&(a.x=-30)}}),M.stage.addEventListener("pressup",function(e){M.isDraging=!1}),M.stage.addEventListener("mousedown",u),M.rbGTeach[0].btnS.addEventListener("click",r),M.rbGTeach[1].btnS.addEventListener("click",r),M.rbGTeach[2].btnS.addEventListener("click",r),M.rbGTeach[3].btnS.addEventListener("click",r),r();for(var i=1;i<=4;i++)for(var n=1;n<=4;n++)M.myFlash.theGame.questionGame.allBtnAnser["b"+String(i)+String(n)].on("click",h);M.myFlash.theGameOver.btnPlayagain.on("click",m),M.digitMax=20,M.textDigitsGameover=[],M.textDigitsInfoOO=[],M.textDigitsInfoXX=[];for(var l=0;l<M.digitMax;l++){var s;(s=new e.numYellowWithRed).scaleX=s.scaleY=.5,s.x=27*l+5,s.y=-5,s.visible=!1,M.myFlash.theGameOver.textCountOO.addChild(s),M.textDigitsGameover.push(s),(s=new e.numYellow).scaleX=s.scaleY=.8,s.x=100+40*l,s.y=45,s.visible=!1,M.myFlash.theGame.theInfoPanel.infoCountOOXX.addChild(s),M.textDigitsInfoOO.push(s),(s=new e.numYellow).scaleX=s.scaleY=.8,s.x=100+40*l,s.y=155,s.visible=!1,M.myFlash.theGame.theInfoPanel.infoCountOOXX.addChild(s),M.textDigitsInfoXX.push(s)}m(),setInterval(o,1e3/30),MyJS.myResize()}}();