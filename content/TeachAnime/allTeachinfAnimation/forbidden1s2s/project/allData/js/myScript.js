'use strict';var isBB,conA,conB,conC,fps=60,log=console.log,courseMD="O",gameMDA=0,isPlayA=!0,isPlayB=!0;const ligZ=60,dotNN=100,arDelta=5,arL=6,lambda=30;var theLigL,theLigC,theLigR,atomB,atomC,photonC,logoC,dxx=0,tt=0,ql=1,qm=0,gameMDC=1,isAfterC=!1;function init(){ground.visible=!1,logo.visible=!1,conA=new THREE.Object3D,scene.add(conA),theLigL=new LightBeam("L"),theLigC=new LightBeam("C"),theLigR=new LightBeam("R"),theLigL.position.x=-20,theLigR.position.x=20,conA.add(theLigL).add(theLigC).add(theLigR),world2D.controlA.slShift.minimum=-.25,world2D.controlA.slShift.maximum=.25,world2D.controlA.slShift.digitN=2,world2D.controlA.slShift.value=0,world2D.controlA.slCombine.minimum=0,world2D.controlA.slCombine.maximum=1,world2D.controlA.slCombine.value=1,world2D.controlA.btnPlayStop.on("click",clickPlayStopA),world2D.controlB.btnPlayStop.on("click",clickPlayStopB),world2D.controlA.rbVV.on("click",clickRB),world2D.controlA.rbHH.on("click",clickRB),world2D.controlA.rbRR.on("click",clickRB),world2D.controlA.rbLL.on("click",clickRB),world2D.controlA.rbMLine.on("click",clickRB),world2D.controlA.rbMLine.checked=!0,world2D.controlA.rbMCircle.on("click",clickRB),world2D.controlA.rbMVH.on("click",clickRB),world2D.controlA.rbMRL.on("click",clickRB),world2D.controlA.rbVV.checked=!0,world2D.controlA.rbRR.checked=!0,conB=new THREE.Object3D,scene.add(conB),atomB=new SHObject(4,3),conB.add(atomB);let a=new TEACHER.ObjPicPlane(180.5/2,41.1/2,"allData/pics/YLM.png","z",2);a.position.z=-50,conB.add(a),world2D.controlB.nsL.btnP.on("click",clickNS),world2D.controlB.nsL.btnM.on("click",clickNS),world2D.controlB.nsM.btnP.on("click",clickNS),world2D.controlB.nsM.btnM.on("click",clickNS),conC=new THREE.Object3D,scene.add(conC),atomC=new SHObject(1,1),photonC=new LightBeam("C"),conC.add(atomC).add(photonC),logoC=new THREE.Object3D,logoC.position.y=15,conC.add(logoC);let b=12;logoC.c1s2s=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2s.png","z",2),logoC.c1s2p0A=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2p0A.png","z",2),logoC.c1s2p0B=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2p0B.png","z",2),logoC.c1s2ppA=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2ppA.png","z",2),logoC.c1s2ppB=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2ppB.png","z",2),logoC.c1s2pmA=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2pmA.png","z",2),logoC.c1s2pmB=new TEACHER.ObjPicPlane(40,b,"allData/pics/c1s2pmB.png","z",2),logoC.add(logoC.c1s2s).add(logoC.c1s2p0A).add(logoC.c1s2p0B).add(logoC.c1s2ppA).add(logoC.c1s2ppB).add(logoC.c1s2pmA).add(logoC.c1s2pmB),world2D.controlC.rb1s2s.on("click",clickRB),world2D.controlC.rb1s2p0.on("click",clickRB),world2D.controlC.rb1s2pp.on("click",clickRB),world2D.controlC.rb1s2pm.on("click",clickRB),world2D.controlC.rb1s2p0.checked=!0,world2D.controlC.btnBeforeAfter.on("click",function(){isAfterC=!isAfterC}),setGameMDA(1),world2D.mainMenu.mBtnA.on("click",clickMBtn),world2D.mainMenu.mBtnB.on("click",clickMBtn),world2D.mainMenu.mBtnC.on("click",clickMBtn),world2D.mainMenu.tweeing=0,world2D.mainMenu.pointerX=0,setInterval(tick,1e3/fps)}function tick(){setCourse(courseMD),"A"===courseMD?(isBB=world2D.controlA.chBB.checked,dxx+=isPlayA?.05:0,.02>Math.abs(world2D.controlA.slShift.value)&&(world2D.controlA.slShift.value=0),1===gameMDA?world2D.controlA.rbVV.checked?theLigC.setWaveXY(0,1,0,0,-dxx):theLigC.setWaveXY(1,0,0,0,-dxx):2===gameMDA?world2D.controlA.rbRR.checked?theLigC.setWaveXY(1,1,0,Math.PI/2,-dxx):theLigC.setWaveXY(1,1,0,-Math.PI/2,-dxx):3===gameMDA?(theLigL.setWaveXY(0,1,0,0,-dxx),theLigR.setWaveXY(1,0,2*world2D.controlA.slShift.value*Math.PI,0,-dxx),theLigC.setWaveAB(theLigL,theLigR)):4===gameMDA&&(theLigL.setWaveXY(1,1,0,-Math.PI/2,-dxx),theLigR.setWaveXY(1,1,0,Math.PI/2,-dxx+2*world2D.controlA.slShift.value*Math.PI),theLigC.setWaveAB(theLigL,theLigR)),theLigC.visible=3>gameMDA||world2D.controlA.chCombine.checked,theLigL.position.x=-20*world2D.controlA.slCombine.value,theLigR.position.x=20*world2D.controlA.slCombine.value):"B"===courseMD?(tt+=.05*(isPlayB?1:0),atomB.ql=ql,atomB.qm=qm,atomB.showSphereGeo(),atomB.showSphereMat(),world2D.controlB.nsL.ttt.text=ql,world2D.controlB.nsM.ttt.text=qm):"C"===courseMD&&(tt+=.05,isAfterC?0===gameMDC?(atomC.ql=0,atomC.qm=0):1===gameMDC?(atomC.ql=1,atomC.qm=0):2===gameMDC?(atomC.ql=1,atomC.qm=-1):3===gameMDC&&(atomC.ql=1,atomC.qm=1):(atomC.ql=0,atomC.qm=0),atomC.showSphereGeo(),atomC.showSphereMat(),isBB=!1,2>gameMDC?(photonC.position.x=-40,photonC.position.y=0,photonC.rotation.y=Math.PI/2,photonC.rotation.x=0,photonC.setWaveXY(0,1,0,0,-tt+Math.PI/2)):(photonC.position.x=0,photonC.position.y=-40,photonC.rotation.y=0,photonC.rotation.x=-Math.PI/2,photonC.setWaveXY(1,1,0,Math.PI/2*(3===gameMDC?1:-1),-tt)),photonC.visible=!isAfterC&&0!=gameMDC,atomC.scale.x=atomC.scale.y=atomC.scale.z=photonC.visible||0===gameMDC?.7:1,logoC.c1s2s.visible=0===gameMDC,logoC.c1s2p0A.visible=1===gameMDC&&!isAfterC,logoC.c1s2p0B.visible=1===gameMDC&&isAfterC,logoC.c1s2ppA.visible=3===gameMDC&&!isAfterC,logoC.c1s2ppB.visible=3===gameMDC&&isAfterC,logoC.c1s2pmA.visible=2===gameMDC&&!isAfterC,logoC.c1s2pmB.visible=2===gameMDC&&isAfterC,world2D.controlC.level.levelX.visible=0===gameMDC,world2D.controlC.level.ee.y=isAfterC&&0!=gameMDC?-100:0),world3D.render(),world2D.stage.update()}MyJS.myResize();function clickPlayStopA(){isPlayA=!isPlayA}function clickPlayStopB(){isPlayB=!isPlayB}function clickRB(a){var b=a.target.parent.name;"rbVV"===b?(world2D.controlA.rbVV.checked=!0,world2D.controlA.rbHH.checked=!1):"rbHH"===b?(world2D.controlA.rbVV.checked=!1,world2D.controlA.rbHH.checked=!0):"rbRR"===b?(world2D.controlA.rbRR.checked=!0,world2D.controlA.rbLL.checked=!1):"rbLL"===b?(world2D.controlA.rbRR.checked=!1,world2D.controlA.rbLL.checked=!0):"rbMLine"===b?(world2D.controlA.rbMLine.checked=!0,world2D.controlA.rbMCircle.checked=!1,world2D.controlA.rbMVH.checked=!1,world2D.controlA.rbMRL.checked=!1,setGameMDA(1)):"rbMCircle"===b?(world2D.controlA.rbMLine.checked=!1,world2D.controlA.rbMCircle.checked=!0,world2D.controlA.rbMVH.checked=!1,world2D.controlA.rbMRL.checked=!1,setGameMDA(2)):"rbMVH"===b?(world2D.controlA.rbMLine.checked=!1,world2D.controlA.rbMCircle.checked=!1,world2D.controlA.rbMVH.checked=!0,world2D.controlA.rbMRL.checked=!1,setGameMDA(3)):"rbMRL"===b?(world2D.controlA.rbMLine.checked=!1,world2D.controlA.rbMCircle.checked=!1,world2D.controlA.rbMVH.checked=!1,world2D.controlA.rbMRL.checked=!0,setGameMDA(4)):"rb1s2s"===b?(world2D.controlC.rb1s2s.checked=!0,world2D.controlC.rb1s2p0.checked=!1,world2D.controlC.rb1s2pp.checked=!1,world2D.controlC.rb1s2pm.checked=!1,0!=gameMDC&&(gameMDC=0,isAfterC=!1)):"rb1s2p0"===b?(world2D.controlC.rb1s2s.checked=!1,world2D.controlC.rb1s2p0.checked=!0,world2D.controlC.rb1s2pp.checked=!1,world2D.controlC.rb1s2pm.checked=!1,1!=gameMDC&&(gameMDC=1,isAfterC=!1)):"rb1s2pm"===b?(world2D.controlC.rb1s2s.checked=!1,world2D.controlC.rb1s2p0.checked=!1,world2D.controlC.rb1s2pp.checked=!1,world2D.controlC.rb1s2pm.checked=!0,2!=gameMDC&&(gameMDC=2,isAfterC=!1)):"rb1s2pp"===b&&(world2D.controlC.rb1s2s.checked=!1,world2D.controlC.rb1s2p0.checked=!1,world2D.controlC.rb1s2pp.checked=!0,world2D.controlC.rb1s2pm.checked=!1,3!=gameMDC&&(gameMDC=3,isAfterC=!1))}function clickNS(a){var b=a.target.parent.name,c=a.target.name;"nsL"===b?("btnP"===c?ql++:"btnM"===c&&ql--,9<ql&&(ql=9),0>ql&&(ql=0),Math.abs(qm)>ql&&(qm=ql*qm/Math.abs(qm))):"nsM"===b&&("btnP"===c?qm++:"btnM"===c&&qm--,qm>ql&&(qm=ql),qm<-ql&&(qm=-ql))}function setCourse(a){"O"===courseMD?(world2D.mainMenu.tweeing=0,world2D.mainMenu.isTweened=!1):!world2D.mainMenu.isTweened&&(world2D.mainMenu.tweeing+=.01,1<world2D.mainMenu.tweeing&&(world2D.mainMenu.tweeing=1,world2D.mainMenu.isTweened=!0,world2D.mainMenu.mmbg.visible=!1),world2D.mainMenu.y=850*world2D.mainMenu.tweeing+450*(1-world2D.mainMenu.tweeing),world2D.mainMenu.scaleX=world2D.mainMenu.scaleY=.5*world2D.mainMenu.tweeing+(1-world2D.mainMenu.tweeing),world2D.mainMenu.mmbg.alpha=1-world2D.mainMenu.tweeing),a!==courseMD&&(courseMD=a,world2D.controlA.visible="A"===a,world2D.controlB.visible="B"===a,world2D.controlC.visible="C"===a,conA.visible="A"===a,conB.visible="B"===a,conC.visible="C"===a,world2D.mainMenu.pointerX="A"===a?-500:"C"===a?500:0),world2D.mainMenu.menuPointer.x=.95*world2D.mainMenu.menuPointer.x+.05*world2D.mainMenu.pointerX}function setGameMDA(a){gameMDA!=a&&(gameMDA=a,theLigL.visible=theLigR.visible=2<gameMDA,world2D.controlA.slShift.visible=world2D.controlA.slCombine.visible=2<gameMDA,world2D.controlA.rbRR.visible=world2D.controlA.rbLL.visible=2===gameMDA,world2D.controlA.rbVV.visible=world2D.controlA.rbHH.visible=1===gameMDA,world2D.controlA.chCombine.visible=2<gameMDA,world2D.controlA.rbMLine.checked=1===gameMDA,world2D.controlA.rbMCircle.checked=2===gameMDA,world2D.controlA.rbMVH.checked=3===gameMDA,world2D.controlA.rbMRL.checked=4===gameMDA)}function clickMBtn(a){var b=a.target.name;setCourse(b.charAt(4))}class LightBeam extends THREE.Object3D{constructor(a){super();let b=this;b.sub="C"!=a,b.axes=new TEACHER.ObjCylinder(.2,ligZ,16751001,!1,"z"),b.axeAr=new TEACHER.ObjArrow(.4,16751001),b.axeAr.position.z=30,b.axeAr.setArrow(0,0,10),b.add(b.axes).add(b.axeAr);let c=.4;b.screen=new THREE.Object3D;var d=new TEACHER.ObjBox(20+c,c,c,10066329);d.position.y=10,b.screen.add(d);var d=new TEACHER.ObjBox(20+c,c,c,10066329);d.position.y=-10,b.screen.add(d),d=new TEACHER.ObjBox(c,20-c,c,10066329),d.position.x=10,b.screen.add(d),d=new TEACHER.ObjBox(c,20-c,c,10066329),d.position.x=-10,b.screen.add(d),d=new TEACHER.ObjBox(.2,15,.2,16777113),b.screen.add(d),d=new TEACHER.ObjBox(15,.2,.2,16777113),b.screen.add(d),b.screenArrow=new TEACHER.ObjArrow(.6,16776960),b.screen.add(b.screenArrow),b.screenLine=new TEACHER.Line(16776960,2,dotNN/2+1);for(var e=0;e<=dotNN/2;e++)b.screenLine.addPoint(0,1,0);b.screen.add(b.screenLine),b.screen.position.z=30,b.add(b.screen),b.dots=[],b.eline=new TEACHER.Line(6750054,b.sub?1:3,dotNN+1),b.bline=new TEACHER.Line(16711935,b.sub?1:3,dotNN+1),b.arrowsE=[],b.arrowsB=[];for(var e=0;e<=dotNN;e++)if(b.dots.push([0,0,-30+e/dotNN*ligZ]),b.eline.addPoint(0,0,-30+e/dotNN*ligZ),b.bline.addPoint(0,0,-30+e/dotNN*ligZ),0==e%arDelta){var f=new TEACHER.ObjArrow(b.sub?.2:.5,6750054);b.arrowsE.push(f),b.add(f),f.setArrow(arL,0,0),f.position.set(0,0,-30+e/dotNN*ligZ);var f=new TEACHER.ObjArrow(b.sub?.2:.5,16738047);b.arrowsB.push(f),b.add(f),f.setArrow(0,arL,0),f.position.set(0,0,-30+e/dotNN*ligZ)}b.add(b.eline).add(b.bline),b.bline.rotation.z=.5*Math.PI}setWaveXY(a,b,c,d,e){for(var f=this,g=0;g<=dotNN;g++)f.dots[g][0]=a*Math.sin(4*Math.PI*g/dotNN+c+e),f.dots[g][1]=b*Math.sin(4*Math.PI*g/dotNN+d+e);f.showWave()}setWaveAB(a,b){for(var c=this,d=0;d<=dotNN;d++)c.dots[d][0]=a.dots[d][0]+b.dots[d][0],c.dots[d][1]=a.dots[d][1]+b.dots[d][1];c.showWave()}showWave(){for(var a=this,b=0;b<=dotNN;b++){var c=a.dots[b][0],d=a.dots[b][1];if(a.eline.setPoint(b,arL*c,arL*d,-30+b/dotNN*ligZ),a.bline.setPoint(b,arL*c,arL*d,-30+b/dotNN*ligZ),0==b%arDelta){var e=a.arrowsE[Math.floor(b/arDelta)];e.setArrow(arL*c,arL*d,0);var f=a.arrowsB[Math.floor(b/arDelta)];f.setArrow(arL*c,arL*d,0),f.rotation.z=Math.PI/2,f.visible=isBB}}a.eline.update(),a.bline.update(),a.bline.visible=isBB,a.screenArrow.setArrow(arL*c,arL*d,0),a.screen.visible=!a.sub,a.arrowsE[dotNN/arDelta].visible=a.sub;for(var b=0;b<=dotNN/2;b++)a.screenLine.setPoint(b,arL*a.dots[b][0],arL*a.dots[b][1],0);a.screenLine.update()}}class SHObject extends THREE.Object3D{constructor(a,b,c){super();var d=this;d.ql=a,d.qm=b,d.isLow=c,d.segW=d.isLow?32:64,d.segH=d.isLow?32:64,d.geo=new THREE.SphereGeometry(15,d.segW,d.segH),d.matCanvas2D=document.createElement("canvas"),d.matCanvas2D.width=d.matCanvas2D.height=d.canvasWH=d.isLow?256:512,d.mapTexture=new THREE.Texture(d.matCanvas2D),d.mapTexture.needsUpdate=!0;var e=new THREE.MeshBasicMaterial({map:d.mapTexture});d.mesh=new THREE.Mesh(d.geo,e),d.add(d.mesh),d.ctx=d.matCanvas2D.getContext("2d"),d.imageData=d.ctx.getImageData(0,0,d.canvasWH,d.canvasWH)}showSphereGeo(){for(var a=this,b=a.ql,c=a.qm,d=a.geo.attributes.position.array,e=0;e<=a.segH;e++)for(var f=Math.PI*e/a.segH,g=a.getSPHYlm(b,c,f),h=0;h<=a.segW;h++){var i=2*Math.PI*h/a.segW,j=g*Math.cos(c*i-tt);j=10+9*j,d[3*(e*(a.segW+1)+h)+0]=j*Math.sin(f)*Math.sin(i),d[3*(e*(a.segW+1)+h)+1]=j*Math.cos(f),d[3*(e*(a.segW+1)+h)+2]=j*Math.sin(f)*Math.cos(i)}a.geo.attributes.position.needsUpdate=!0,a.geo.computeBoundingBox(),a.geo.computeBoundingSphere()}showSphereMat(){var a=this,b=a.qm,c=a.ql;let e=a.imageData.data,d=e.length;var f=a.canvasWH;let g=new THREE.Color,h=2;for(var i=0;i<f;i+=h)for(var l=Math.PI*i/f,m=a.getSPHYlm(c,b,l),n=0;n<f;n+=h){var o=2*Math.PI*n/f,p=m*Math.cos(b*o-tt);g.setHSL(1/3-.7*p,1,.5);for(var q=0;q<h;q++)for(var r=0;r<h;r++)e[4*((i+q)*f+(n+r))+0]=255*g.r,e[4*((i+q)*f+(n+r))+1]=255*g.g,e[4*((i+q)*f+(n+r))+2]=255*g.b,e[4*((i+q)*f+(n+r))+3]=255}a.ctx.putImageData(a.imageData,0,0),a.ctx.strokeStyle="#333333",a.ctx.lineWidth=1,a.ctx.beginPath();for(var s=a.isLow?16:32,i=0;i<f;i+=s)a.ctx.moveTo(0,i),a.ctx.lineTo(f,i);for(var n=0;n<f;n+=s)a.ctx.moveTo(n,0),a.ctx.lineTo(n,f);a.ctx.stroke(),a.mapTexture.needsUpdate=!0}getSPHYlm(a,b,d){let e=Math.sin(d),f=Math.cos(d),c=Math.PI,g=Math.sqrt,h=Math.pow,i=Math.abs,j=0;return 0===a?j=g(1/c)/2:1===a?1===i(b)?j=g(3/2/c)/2*e:0===b&&(j=g(3/c)/2*f):2===a?2===i(b)?j=g(15/2/c)/4*h(e,2):1===i(b)?j=g(15/2/c)/2*e*f:0===b&&(j=g(5/c)/4*(3*h(f,2)-1)):3===a?3===i(b)?j=g(35/c)/8*h(e,3):2===i(b)?j=g(105/2/c)/4*h(e,2)*f:1===i(b)?j=g(21/c)/8*e*(5*h(f,2)-1):0===b&&(j=g(7/c)/4*(5*h(f,3)-3*f)):4===a?4===i(b)?j=3*g(35/2/c)/16*h(e,4):3===i(b)?j=3*g(35/c)/8*h(e,3)*f:2===i(b)?j=3*g(5/2/c)/8*h(e,2)*(7*h(f,2)-1):1===i(b)?j=3*g(5/c)/8*e*(7*h(f,3)-3*f):0===b&&(j=3*g(1/c)/16*(35*h(f,4)-30*h(f,2)+3)):5===a?5===i(b)?j=3*g(77/c)/32*h(e,5):4===i(b)?j=3*g(385/2/c)/16*h(e,4)*f:3===i(b)?j=1*g(385/c)/32*h(e,3)*(9*h(f,2)-1):2===i(b)?j=1*g(1155/2/c)/8*h(e,2)*(3*h(f,3)-f):1===i(b)?j=1*g(165/2/c)/16*e*(21*h(f,4)-14*h(f,2)+1):0===b&&(j=1*g(11/c)/16*(63*h(f,5)-70*h(f,3)+15*f)):6===a?6===i(b)?j=g(3003/c)/64*h(e,6):5===i(b)?j=3*g(1001/c)/32*h(e,5)*f:4===i(b)?j=3*g(91/2/c)/32*h(e,4)*(11*h(f,2)-1):3===i(b)?j=g(1635/c)/32*h(e,3)*(11*h(f,3)-3*f):2===i(b)?j=g(1365/c)/64*h(e,2)*(33*h(f,4)-18*h(f,2)+1):1===i(b)?j=g(273/2/c)/16*e*(33*h(f,5)-30*h(f,3)+5*f):0===b&&(j=g(13/c)/32*(231*h(f,6)-315*h(f,4)+105*h(f,2)-5)):7===a?7===i(b)?j=3*g(715/2/c)/64*h(e,7):6===i(b)?j=3*g(5005/c)/64*h(e,6)*f:5===i(b)?j=3*g(385/2/c)/64*h(e,5)*(13*h(f,2)-1):4===i(b)?j=3*g(385/2/c)/32*h(e,4)*(13*h(f,3)-3*f):3===i(b)?j=3*g(35/2/c)/64*h(e,3)*(143*h(f,4)-66*h(f,2)+3):2===i(b)?j=3*g(35/c)/64*h(e,2)*(143*h(f,5)-110*h(f,3)+15*f):1===i(b)?j=g(105/2/c)/64*e*(429*h(f,6)-495*h(f,4)+135*h(f,2)-5):0===b&&(j=g(15/c)/32*(429*h(f,7)-693*h(f,5)+315*h(f,3)-35*f)):8===a?8===i(b)?j=3*g(12155/2/c)/256*h(e,8):7===i(b)?j=3*g(12155/2/c)/64*h(e,7)*f:6===i(b)?j=g(7293/c)/128*h(e,6)*(15*h(f,2)-1):5===i(b)?j=3*g(17017/2/c)/64*h(e,5)*(5*h(f,3)-f):4===i(b)?j=3*g(1309/2/c)/128*h(e,4)*(65*h(f,4)-26*h(f,2)+1):3===i(b)?j=g(19635/2/c)/64*h(e,3)*(39*h(f,5)-26*h(f,3)+3*f):2===i(b)?j=3*g(595/c)/128*h(e,2)*(143*h(f,6)-143*h(f,4)+33*h(f,2)-1):1===i(b)?j=3*g(17/2/c)/64*e*(715*h(f,7)-1001*h(f,5)+385*h(f,3)-35*f):0===b&&(j=g(17/c)/256*(6435*h(f,8)-12012*h(f,6)+6930*h(f,4)-1260*h(f,2)+35)):9==a&&(9===i(b)?j=g(230945/c)/512*h(e,9):8===i(b)?j=3*g(230945/2/c)/256*h(e,8)*f:7===i(b)?j=3*g(13585/c)/512*h(e,7)*(17*h(f,2)-1):6===i(b)?j=g(40755/c)/128*h(e,6)*(17*h(f,3)-3*f):5===i(b)?j=3*g(2717/c)/256*h(e,5)*(85*h(f,4)-30*h(f,2)+1):4===i(b)?j=3*g(95095/2/c)/128*h(e,4)*(17*h(f,5)-10*h(f,3)+f):3===i(b)?j=g(21945/c)/256*h(e,3)*(221*h(f,6)-195*h(f,4)+39*h(f,2)-1):2===i(b)?j=3*g(1045/c)/128*h(e,2)*(221*h(f,7)-273*h(f,5)+91*h(f,3)-7*f):1===i(b)?j=3*g(95/2/c)/256*e*(2431*h(f,8)-4004*h(f,6)+2002*h(f,4)-308*h(f,2)+7):0===b&&(j=g(19/c)/256*(12155*h(f,9)-25740*h(f,7)+18018*h(f,5)-4620*h(f,3)+315*f))),0<b&&1==b%2&&(j*=-1),j}}var TEACHER={};TEACHER.ObjPlane=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this;f.mat=new TEACHER.MSMat(c,e),f.geo=new THREE.PlaneGeometry(a||10,b||10,1,1),f.mesh=new THREE.Mesh(f.geo,f.mat),"x"===d?f.mesh.rotation.y=.5*Math.PI:"y"==d&&(f.mesh.rotation.x=-.5*Math.PI),f.add(f.mesh)}},TEACHER.ObjCylinder=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this;g.mat=new TEACHER.MSMat(c,f),g.geo=new THREE.CylinderGeometry(a||10,a||10,b||10,32,2,d),g.mesh=new THREE.Mesh(g.geo,g.mat),"x"===e?g.mesh.rotation.z=-.5*Math.PI:"z"==e&&(g.mesh.rotation.x=.5*Math.PI),g.add(g.mesh)}},TEACHER.ObjSphere=class extends THREE.Object3D{constructor(a,b,c){super();let d=this;d.mat=new TEACHER.MSMat(b,c),d.geo=new THREE.SphereGeometry(a||10,32,16),d.mesh=new THREE.Mesh(d.geo,d.mat),d.add(d.mesh)}},TEACHER.ObjBox=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this;f.mat=new TEACHER.MSMat(d,e),f.geo=new THREE.BoxGeometry(a||10,b||10,c||10),f.mesh=new THREE.Mesh(f.geo,f.mat),f.add(f.mesh)}},TEACHER.MSMat=class extends THREE.MeshStandardMaterial{constructor(a,b){super({color:a||16711935,roughness:.4,side:b||0})}},TEACHER.ObjPicPlane=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this,g=new THREE.TextureLoader().load(c);f.mat=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:e||0}),f.geo=new THREE.PlaneGeometry(a,b,1,1),f.mesh=new THREE.Mesh(f.geo,f.mat),"x"===d?f.mesh.rotation.y=.5*Math.PI:"y"==d&&(f.mesh.rotation.x=-.5*Math.PI),f.add(f.mesh)}},TEACHER.ObjPicCylinder=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this,h=new THREE.TextureLoader().load(c);g.mat=new THREE.MeshBasicMaterial({map:h,side:f||0}),g.geo=new THREE.CylinderGeometry(a||10,a||10,b||10,32,4,d),g.mesh=new THREE.Mesh(g.geo,g.mat),"x"===e?g.mesh.rotation.z=-.5*Math.PI:"z"===e?(g.mesh.rotation.y=.5*Math.PI,g.mesh.rotation.x=.5*Math.PI):"y"==e&&(g.mesh.rotation.y=.5*Math.PI),g.add(g.mesh)}},TEACHER.ObjPicSphere=class extends THREE.Object3D{constructor(a,b,c){super();let d=this,e=new THREE.TextureLoader().load(b);d.mat=new THREE.MeshBasicMaterial({map:e,side:c||0}),d.geo=new THREE.SphereGeometry(a||10,32,16),d.mesh=new THREE.Mesh(d.geo,d.mat),d.add(d.mesh)}},TEACHER.ObjArrow=class extends THREE.Object3D{constructor(a,b){super();let c=.35,d=.5,e=new THREE.MeshStandardMaterial({color:b||16711935,roughness:.4}),f=new THREE.ConeGeometry(a||10,35,32);this.ArrowHead=new THREE.Mesh(f,e),this.ArrowHead.position.y=100*(1-.5*c),f=new THREE.CylinderGeometry((a||10)*d,(a||10)*d,65,32,2),this.ArrowBody=new THREE.Mesh(f,e),this.ArrowBody.position.y=50*(1-c),this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.ArrowBody),this.rotX.add(this.ArrowHead)}setArrow(a,b,c){let d=a*a+b*b+c*c,e=Math.sqrt(d);0<d?(this.rotX.visible=!0,this.rotX.scale.y=e/100):this.rotX.visible=!1,this.rotX.rotation.x=Math.acos(b/e),this.rotY.rotation.y=Math.atan2(a,c)}},TEACHER.ObjSpring=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=a||20;this.L0=f;let g=[],h=d||5,j=b||5,k=c||.5;g.push(new THREE.Vector3(0,0,0)),g.push(new THREE.Vector3(0,.05*f,0));for(var l=0;l<=16*h;l++)g.push(new THREE.Vector3(j*Math.cos(2*l*Math.PI/16),f*(.05+.9*l/h/16),j*Math.sin(2*l*Math.PI/16)));g.push(new THREE.Vector3(0,.95*f,0)),g.push(new THREE.Vector3(0,f,0));let m=new THREE.CatmullRomCurve3(g),n=new THREE.MeshStandardMaterial({color:e||16711935,roughness:.4}),o=new THREE.TubeGeometry(m,200,k,12);this.mesh=new THREE.Mesh(o,n),this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.mesh),this.nn=h,this.rB=j,this.rS=k,this.bar1=new TEACHER.ObjCylinder(k,100,e||16711935,!1,"y"),this.bar2=new TEACHER.ObjCylinder(k,100,e||16711935,!1,"x"),this.bar3=new TEACHER.ObjCylinder(k,100,e||16711935,!1,"x"),this.bar4=new TEACHER.ObjCylinder(k,100,e||16711935,!1,"y"),this.rotX.add(this.bar1).add(this.bar2).add(this.bar3).add(this.bar4)}setSpring(a,b,c){let d=a*a+b*b+c*c,e=Math.sqrt(d);0<d?(this.rotX.visible=!0,this.rotX.scale.y=e/this.L0):this.rotX.visible=!1,this.rotX.rotation.x=Math.acos(b/e),this.rotY.rotation.y=Math.atan2(a,c)}setSpringNew(a,b,c){let d=a*a+b*b+c*c,e=Math.sqrt(d);if(0<d){this.rotX.visible=!0;let a=e,b=[],c=this.nn,d=this.rB,g=this.rS;b.push(new THREE.Vector3(0,0,0)),b.push(new THREE.Vector3(0,.05*a,0));for(var f=0;f<=16*c;f++)b.push(new THREE.Vector3(d*Math.cos(2*f*Math.PI/16),a*(.05+.9*f/c/16),d*Math.sin(2*f*Math.PI/16)));b.push(new THREE.Vector3(0,.95*a,0)),b.push(new THREE.Vector3(0,a,0));let h=new THREE.CatmullRomCurve3(b),i=new THREE.TubeGeometry(h,500,g,12);this.mesh.geometry=i}else this.rotX.visible=!1;this.rotX.rotation.x=Math.acos(b/e),this.rotY.rotation.y=Math.atan2(a,c)}setSpringNew222(a,b,c){let d=a*a+b*b+c*c,e=Math.sqrt(d);if(0<d){this.rotX.visible=!0;let a=this.nn,b=this.rB,c=this.rS;const d=this.mesh.geometry.attributes.position.array;for(var f=0;201>f;f++)for(var g=2*(f/200*a)*Math.PI,h=b*Math.cos(g),k=.8*e*f/200+.1*e,l=b*Math.sin(g),m=0;13>m;m++){var n=-2*Math.PI/12*m+Math.PI,o=h+c*Math.cos(n)*Math.cos(g),p=k+c*Math.sin(n),q=l+c*Math.cos(n)*Math.sin(g);d[3*(13*f)+3*m]=o,d[3*(13*f)+3*m+1]=p,d[3*(13*f)+3*m+2]=q}this.bar1.scale.y=this.bar4.scale.y=.1*e/100,this.bar2.scale.x=this.bar3.scale.x=b/100,this.bar1.position.y=.1*e/2,this.bar4.position.y=e*(1-.1/2),this.bar2.position.y=.1*e,this.bar3.position.y=e*(1-.1),this.bar2.position.x=this.bar3.position.x=.5*b}else this.rotX.visible=!1;this.rotX.rotation.x=Math.acos(b/e),this.rotY.rotation.y=Math.atan2(a,c),this.mesh.geometry.attributes.position.needsUpdate=!0,this.mesh.geometry.computeVertexNormals()}},TEACHER.Points=class extends THREE.Points{constructor(a,b,c){let d=new THREE.Color(a||16711935),e=new THREE.BufferGeometry,f=[];e.setAttribute("position",new THREE.Float32BufferAttribute(f,3)),e.computeBoundingSphere();let g=new THREE.PointsMaterial({size:b||1,map:TEACHER.Points.createCanvasMaterial("#"+d.getHexString(),64),transparent:!0,depthWrite:!1});super(e,g);let h=this;h.nnMax=c||1e4,h.nnNow=0,h.geometry=e,h.positions=f}static createCanvasMaterial(a,b){var c=document.createElement("canvas");c.width=c.height=b;var d=c.getContext("2d");d.imageSmoothingEnabled=!1;var e=new THREE.Texture(c),f=b/2;return d.beginPath(),d.arc(f,f,b/2-3,0,2*Math.PI,!1),d.closePath(),d.fillStyle=a,d.fill(),e.needsUpdate=!0,e}addPoint(a,b,c){let d=this;d.nnNow<d.nnMax?d.nnNow++:(log("TEACHER.Points \u5230\u9054\u6700\u5927\u9EDE\u6578"),d.positions.shift(),d.positions.shift(),d.positions.shift()),d.positions.push(a,b,c)}clear(){let a=this;a.positions=[],a.nnNow=0,a.update()}setPoint(a,b,c,d){let e=this;a>e.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u6700\u5927\u9EDE\u6578 nnMax"):a>e.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u73FE\u5728\u9EDE\u6578 nnNow"):(e.positions[3*a]=b,e.positions[3*a+1]=c,e.positions[3*a+2]=d)}getPoint(a){let b=this,c=new THREE.Vector3;return a>b.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u6700\u5927\u9EDE\u6578 nnMax"):a>b.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u73FE\u5728\u9EDE\u6578 nnNow"):(c.x=b.positions[3*a],c.y=b.positions[3*a+1],c.z=b.positions[3*a+2]),c}update(){let a=this;a.geometry.setAttribute("position",new THREE.Float32BufferAttribute(a.positions,3)),a.geometry.computeBoundingSphere(),a.geometry.attributes.position.needsUpdate=!0}},TEACHER.Line=class extends THREE.Line2{constructor(a,b,c){let d=c||1e4;var e=new THREE.LineMaterial({color:a||16711935,linewidth:b||1});e.resolution.set(window.innerWidth,window.innerHeight);let f=new THREE.LineGeometry,g=new Float32Array(3*d);f.setPositions(g),super(f,e);let h=this;h.nnMax=d,h.lineWidth=b||1,h.nnNow=0,h.geometry=f,h.positions=g}addPoint(a,b,c){let d=this;if(d.nnNow<d.nnMax)d.nnNow++;else{log("TEACHER.Line \u5230\u9054\u6700\u5927\u9EDE\u6578");for(var e=0;e<d.nnMax-1;e++)d.positions[3*e]=d.positions[3*e+3],d.positions[3*e+1]=d.positions[3*e+4],d.positions[3*e+2]=d.positions[3*e+5]}for(var e=d.nnNow;e<=d.nnMax;e++)d.positions[3*(e-1)]=a,d.positions[3*(e-1)+1]=b,d.positions[3*(e-1)+2]=c}clear(){let a=this;a.positions=new Float32Array(3*a.nnMax);a.nnNow=0}setPoint(a,b,c,d){let e=this;a>e.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u6700\u5927\u9EDE\u6578 nnMax"):a>e.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u73FE\u5728\u9EDE\u6578 nnNow"):(e.positions[3*a]=b,e.positions[3*a+1]=c,e.positions[3*a+2]=d)}getPoint(a){let b=this,c=new THREE.Vector3;return a>b.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u6700\u5927\u9EDE\u6578 nnMax"):a>b.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u73FE\u5728\u9EDE\u6578 nnNow"):(c.x=b.positions[3*a],c.y=b.positions[3*a+1],c.z=b.positions[3*a+2]),c}update(){let a=this,b=a.getPoint(a.nnNow-1);for(var c=a.nnNow;c<=a.nnMax;c++)a.positions[3*c]=b.x,a.positions[3*c+1]=b.y,a.positions[3*c+2]=b.z;a.geometry.setPositions(a.positions)}},TEACHER.ObjTextPlane=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this,h=Math.round(Math.log2(a/b)),i=$("<canvas>").attr("width",128*Math.pow(2,h)+"").attr("height","128");g.stage=new createjs.Stage(i[0]);let j=new createjs.Container;if(f){let a=new createjs.Shape,b=new THREE.Color(f);a.graphics.c().f("#"+b.getHexString()).dr(0,0,128*Math.pow(2,h),128),j.addChild(a)}g.ctext=new createjs.Text;let k=new THREE.Color(e||16777215);g.ctext.color="#"+k.getHexString(),g.ctext.font="96px Arial",g.ctext.text=c||"",g.ctext.textAlign="center",g.ctext.textBaseline="middle",g.ctext.x=128*Math.pow(2,h)/2,g.ctext.y=64,j.addChild(g.ctext),g.stage.addChild(j),g.stage.update(),g.texture=new THREE.Texture(i[0]);var l=new THREE.MeshBasicMaterial({map:g.texture,transparent:!0}),m=new THREE.PlaneGeometry(a||10,b||10,1,1);g.texture.needsUpdate=!0,g.plane1=new THREE.Mesh(m,l),g.plane2=new THREE.Mesh(m,l),g.plane2.rotation.y=Math.PI;let n=new THREE.Object3D;n.add(g.plane1).add(g.plane2),"x"===d?n.rotation.y=.5*Math.PI:"y"==d&&(n.rotation.x=-.5*Math.PI),g.add(n)}setText(a){let b=this;b.ctext.text=a,b.stage.update(),b.texture.needsUpdate=!0}},TEACHER.ObjGraph=class extends THREE.Object3D{constructor(a,b,c,d,e,f,g){super();let h=this;h.objCon=new THREE.Object3D,h._xMin=a||0,h._xMax=b||10,h._yMin=c||0,h._yMax=d||10,h.divXN=5,h.divYN=4,h.frameMat=new THREE.LineBasicMaterial({color:e||16777215});for(var i=[],j=0;j<=h.divXN;j++)i.push(new THREE.Vector3(-50+20*j,0,0)),i.push(new THREE.Vector3(-50+20*j,50,0));for(var k=0;k<=h.divYN;k++)i.push(new THREE.Vector3(-50,12.5*k,0)),i.push(new THREE.Vector3(50,12.5*k,0));let l=new THREE.BufferGeometry().setFromPoints(i);h.frame=new THREE.LineSegments(l,h.frameMat),h.objCon.add(h.frame),h.labelXMin=new TEACHER.ObjTextPlane(20,5,h._xMin+"","z",e||16777215),h.labelXMin.position.x=-50,h.labelXMin.position.y=-3,h.objCon.add(h.labelXMin),h.labelXMax=new TEACHER.ObjTextPlane(20,5,h._xMax+"","z",e||16777215),h.labelXMax.position.x=50,h.labelXMax.position.y=-3,h.objCon.add(h.labelXMax),h.labelYMin=new TEACHER.ObjTextPlane(20,5,h._yMin+"","z",e||16777215),h.labelYMin.position.x=-53,h.labelYMin.position.y=0,h.objCon.add(h.labelYMin),h.labelYMax=new TEACHER.ObjTextPlane(20,5,h._yMax+"","z",e||16777215),h.labelYMax.position.x=-53,h.labelYMax.position.y=50,h.objCon.add(h.labelYMax),h.labelX=new TEACHER.ObjTextPlane(24,7,"x","z",e||16777215),h.labelX.position.x=60,h.labelX.position.y=4,h.labelX.position.z=1,h.labelY=new TEACHER.ObjTextPlane(24,7,"y","z",e||16777215),h.labelY.position.x=-60,h.labelY.position.y=25,h.labelY.position.z=1,h.labelY.rotation.z=Math.PI/2,h.labelTitle=new TEACHER.ObjTextPlane(40,10,"y-x","z",e||16777215),h.labelTitle.position.y=53,h.labelTitle.position.z=1,h.objCon.add(h.labelX).add(h.labelY).add(h.labelTitle),h._lineColor=f,h._nnMax=g,h.line=new TEACHER.Line(h._lineColor||16776960,2,h._nnMax),h.objCon.add(h.line),h.changeScale(),h.add(h.objCon)}addPoint(a,b){let c=this;c.line.addPoint(a,b,0),c.line.update()}clear(){let a=this;a.line.clear()}changeScale(){let a=this;a.line.scale.x=100/(a._xMax-a._xMin),a.line.scale.y=50/(a._yMax-a._yMin),a.line.position.x=-50-a._xMin*a.line.scale.x,a.line.position.y=-a._yMin*a.line.scale.y,a.labelXMin.setText(a._xMin),a.labelXMax.setText(a._xMax),a.labelYMin.setText(a._yMin),a.labelYMax.setText(a._yMax)}setLabel(a,b,c){let d=this;d.labelTitle.setText(a||"y-x"),d.labelY.setText(b||"y"),d.labelX.setText(c||"x")}get xMin(){return this._xMin}set xMin(a){this._xMin=a,this.changeScale()}get xMax(){return this._xMax}set xMax(a){this._xMax=a,this.changeScale()}get yMin(){return this._yMin}set yMin(a){this._yMin=a,this.changeScale()}get yMax(){return this._yMax}set yMax(a){this._yMax=a,this.changeScale()}};var skyBox=new THREE.Object3D;skyBox.wallU=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallU,"y",1),skyBox.wallD=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallD,"y",0),skyBox.wallS=new TEACHER.ObjPicCylinder(5e3,1e4,pics.wallSide,!0,"y",1),skyBox.wallU.position.y=5e3,skyBox.wallD.position.y=-5e3,skyBox.add(skyBox.wallU).add(skyBox.wallD).add(skyBox.wallS),world3D.scene.add(skyBox);var ground=new TEACHER.ObjPicPlane(100,100,pics.ground,"y");world3D.scene.add(ground);var logo=new TEACHER.ObjPicPlane(60,60/8,pics.logo,"z",2);logo.position.z=-50,logo.position.y=100/8/2,world3D.scene.add(logo);function getMouse3D(a){let b,c=a||"y",d=new THREE.Vector3;"x"===c?b=new THREE.Vector3(1,0,0):"y"===c?b=new THREE.Vector3(0,1,0):"z"===c?b=new THREE.Vector3(0,0,1):log("\u932F\u8AA4!!");let e=new THREE.Vector2;return e.x=2*(world2D.stage.mouseX/1600)-1,e.y=2*-(world2D.stage.mouseY/900)+1,world3D.raycaster.setFromCamera(e,world3D.camera),world3D.raycaster.ray.intersectPlane(new THREE.Plane(b),d),d}TEACHER.CCC=class{constructor(a){this.name=a}},init();