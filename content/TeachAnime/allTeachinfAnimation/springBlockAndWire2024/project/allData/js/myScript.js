'use strict';var fps=60,log=console.log,titleTime=120,gameMD=0,lesson="A";const mm=10,kk=10,dt=.01,L0=20;var x0=15;const gg=5;var worldA,worldB,worldC,cameraFollowRatio=1;function init(){worldA=new WorldA,worldB=new WorldB,worldC=new WorldC,scene.add(worldA).add(worldB).add(worldC),world2D.btnLessonA.on("click",clickLesson),world2D.btnLessonB.on("click",clickLesson),world2D.btnLessonC.on("click",clickLesson),world2D.btnCut.on("click",function(){0===gameMD&&(gameMD=1)}),world2D.btnReset.on("click",function(){1===gameMD&&(gameMD=0)}),world2D.chFollow.checked=!0,world2D.chSlow.checked=!0,world2D.sl01.visible=world2D.sl02.visible=world2D.sl03.visible=!1,world2D.btnUp.visible=world2D.btnDown.visible=world2D.btnLeft.visible=world2D.btnRight.visible=!1,world2D.slCameraRR.value=125,setInterval(tick,1e3/fps)}function tick(){titleTime--,60<titleTime?(world2D.title.x=800,world2D.title.y=450,world2D.title.scaleX=world2D.title.scaleY=2):0<titleTime&&(world2D.title.x=(800*titleTime+280*(60-titleTime))/60,world2D.title.y=(450*titleTime+80*(60-titleTime))/60,world2D.title.scaleX=world2D.title.scaleY=(2*titleTime+.8*(60-titleTime))/60),"A"===lesson?worldA.update():"B"===lesson?worldB.update():"C"===lesson&&worldC.update(),worldA.visible="A"===lesson,worldB.visible="B"===lesson,worldC.visible="C"===lesson,world2D.btnCut.visible=0===gameMD,world2D.btnReset.visible=1===gameMD,world2D.chFollow.visible="A"===lesson,world3D.render(),world2D.stage.update()}MyJS.myResize();function clickLesson(a){let b=a.target.name.charAt(9);lesson!=b&&(gameMD=0,lesson=b)}class WorldA extends THREE.Object3D{constructor(){super();let a=this;a.ballA=new TEACHER.ObjBox(10,10,10,65535),a.ballB=new TEACHER.ObjBox(10,10,10,52224),a.spring=new TEACHER.ObjSpring(L0,3,.3,8,16776960),a.wireL=new TEACHER.ObjCylinder(.5,20,16750848),a.wireL.position.y=990,a.ballA.position.x=a.ballB.position.x=a.wireL.position.x=a.spring.position.x=-15,a.add(a.ballA).add(a.ballB).add(a.spring).add(a.wireL),a.ballC=new TEACHER.ObjBox(10,10,10,65535),a.ballD=new TEACHER.ObjBox(10,10,10,52224),a.wireM=new TEACHER.ObjCylinder(.5,20,16750848),a.wireR=new TEACHER.ObjCylinder(.5,20,16750848),a.wireR.position.y=990,a.ballC.position.x=a.ballD.position.x=a.wireM.position.x=a.wireR.position.x=x0,a.add(a.ballC).add(a.ballD).add(a.wireM).add(a.wireR);let b=new TEACHER.ObjBox(60,5,20,10053120);b.position.y=1e3+2.5,a.add(b);for(var c,d=0;10>d;d++)c=new Ground,c.position.y=100*d+65,c.position.z=-5,a.add(c);a.arMgA=new TEACHER.ObjArrow(1.5,16777215),a.arMgB=new TEACHER.ObjArrow(1.5,16777215),a.arMgC=new TEACHER.ObjArrow(1.5,16777215),a.arMgD=new TEACHER.ObjArrow(1.5,16777215),a.arFkA=new TEACHER.ObjArrow(1.5,16776960),a.arFkB=new TEACHER.ObjArrow(1.5,16776960),a.arFkC=new TEACHER.ObjArrow(1.5,16750848),a.arFkD=new TEACHER.ObjArrow(1.5,16750848),a.arTUL=new TEACHER.ObjArrow(1.5,16750848),a.arTUR=new TEACHER.ObjArrow(1.5,16750848),a.arAccA=new TEACHER.ObjArrow(1.5,16737894),a.arAccB=new TEACHER.ObjArrow(1.5,16737894),a.arAccC=new TEACHER.ObjArrow(1.5,16737894),a.arAccD=new TEACHER.ObjArrow(1.5,16737894),a.add(a.arAccA).add(a.arAccB).add(a.arAccC).add(a.arAccD),a.add(a.arMgA).add(a.arMgB).add(a.arMgC).add(a.arMgD),a.add(a.arFkA).add(a.arFkB).add(a.arFkC).add(a.arFkD),a.add(a.arTUR).add(a.arTUL),a.labelMgA=new TexturePlane(100,100,"textureAll",1),a.labelMgA.textureGotoAndStop(0),a.labelMgB=new TexturePlane(100,100,"textureAll",1),a.labelMgB.textureGotoAndStop(0),a.labelMgC=new TexturePlane(100,100,"textureAll",1),a.labelMgC.textureGotoAndStop(0),a.labelMgD=new TexturePlane(100,100,"textureAll",1),a.labelMgD.textureGotoAndStop(0),a.labelMgA.scale.x=a.labelMgA.scale.y=a.labelMgB.scale.x=a.labelMgB.scale.y=a.labelMgC.scale.x=a.labelMgC.scale.y=a.labelMgD.scale.x=a.labelMgD.scale.y=.08,a.labelFkA=new TexturePlane(100,100,"textureAll",1),a.labelFkA.textureGotoAndStop(2),a.labelFkB=new TexturePlane(100,100,"textureAll",1),a.labelFkB.textureGotoAndStop(2),a.labelFkC=new TexturePlane(100,100,"textureAll",1),a.labelFkC.textureGotoAndStop(1),a.labelFkD=new TexturePlane(100,100,"textureAll",1),a.labelFkD.textureGotoAndStop(1),a.labelFkA.scale.x=a.labelFkA.scale.y=a.labelFkB.scale.x=a.labelFkB.scale.y=a.labelFkC.scale.x=a.labelFkC.scale.y=a.labelFkD.scale.x=a.labelFkD.scale.y=.08,a.labelTUL=new TexturePlane(100,100,"textureAll",1),a.labelTUL.textureGotoAndStop(1),a.labelTUR=new TexturePlane(100,100,"textureAll",1),a.labelTUR.textureGotoAndStop(1),a.labelTUR.scale.x=a.labelTUR.scale.y=a.labelTUL.scale.x=a.labelTUL.scale.y=.08,a.labelAccA=new TexturePlane(100,100,"textureAll",1),a.labelAccA.textureGotoAndStop(3),a.labelAccB=new TexturePlane(100,100,"textureAll",1),a.labelAccB.textureGotoAndStop(3),a.labelAccC=new TexturePlane(100,100,"textureAll",1),a.labelAccC.textureGotoAndStop(3),a.labelAccD=new TexturePlane(100,100,"textureAll",1),a.labelAccD.textureGotoAndStop(3),a.labelAccA.scale.x=a.labelAccA.scale.y=a.labelAccB.scale.x=a.labelAccB.scale.y=a.labelAccC.scale.x=a.labelAccC.scale.y=a.labelAccD.scale.x=a.labelAccD.scale.y=.08,a.add(a.labelMgA).add(a.labelMgB).add(a.labelMgC).add(a.labelMgD),a.add(a.labelFkA).add(a.labelFkB).add(a.labelFkC).add(a.labelFkD),a.add(a.labelAccA).add(a.labelAccB).add(a.labelAccC).add(a.labelAccD),a.add(a.labelTUR).add(a.labelTUL),a.labelMgA.position.z=a.labelMgB.position.z=a.labelMgC.position.z=a.labelMgD.position.z=a.labelFkA.position.z=a.labelFkB.position.z=a.labelFkC.position.z=a.labelFkD.position.z=a.labelTUR.position.z=a.labelTUL.position.z=6,a.labelAccA.position.z=a.labelAccB.position.z=a.labelAccC.position.z=a.labelAccD.position.z=0,a.scissorsL=new Scissors,a.scissorsR=new Scissors,a.add(a.scissorsR).add(a.scissorsL),a.resetGame()}resetGame(){let a=this;a.ballA.position.y=975,a.ballB.position.y=965-L0-50/kk,a.spring.position.y=a.ballA.position.y-5,a.ballA.vy=a.ballB.vy=0,a.ballA.vyOld=a.ballB.vyOld=0,a.spring.setSpring(0,a.ballB.position.y-a.ballA.position.y+10,0),a.ballC.position.y=975,a.ballD.position.y=945,a.wireM.position.y=a.ballC.position.y-5-10,a.ballC.vy=a.ballD.vy=0,a.ballC.vyOld=a.ballD.vyOld=0,a.wireM.visible=!0}update(){let a=this;if(0===gameMD)a.resetGame();else if(1===gameMD){let d=world2D.chSlow.checked?1:10;for(var b,c=0;c<d;c++){if(b=kk*(a.ballA.position.y-a.ballB.position.y-10-L0),a.ballA.vy-=(b/mm+gg)*dt,a.ballB.vy+=(b/mm-gg)*dt,a.ballA.position.y+=a.ballA.vy*dt,a.ballB.position.y+=a.ballB.vy*dt,5>a.ballB.position.y&&0>a.ballB.vy&&(a.ballB.position.y=5,a.ballB.vy*=-.5),10>a.ballA.position.y-a.ballB.position.y&&0>a.ballA.vy-a.ballB.vy){let b=.5*(a.ballA.vy+a.ballB.vy);a.ballA.vy=(1+.5)*b-.5*a.ballA.vy,a.ballB.vy=(1+.5)*b-.5*a.ballB.vy,a.ballA.position.y=a.ballB.position.y+10}if(a.ballC.vy-=gg*dt,a.ballD.vy-=gg*dt,a.ballC.position.y+=a.ballC.vy*dt,a.ballD.position.y+=a.ballD.vy*dt,5>a.ballD.position.y&&(a.ballD.position.y=5,a.ballD.vy*=-.5,a.wireM.visible=!1),10>a.ballC.position.y-a.ballD.position.y&&0>a.ballC.vy-a.ballD.vy){let b=.5*(a.ballC.vy+a.ballD.vy);a.ballC.vy=(1+.5)*b-.5*a.ballC.vy,a.ballD.vy=(1+.5)*b-.5*a.ballD.vy,a.ballC.position.y=a.ballD.position.y+10,a.wireM.visible=!1}}}a.spring.position.y=a.ballA.position.y-5,a.spring.setSpring(0,a.ballB.position.y-a.ballA.position.y+10,0),a.wireL.visible=a.wireR.visible=0===gameMD,a.wireM.position.y=a.ballC.position.y-5-10;let d=.2;a.arMgA.position.x=a.ballA.position.x-.8,a.arMgA.position.y=a.ballA.position.y,a.arMgB.position.x=a.ballB.position.x-.8,a.arMgB.position.y=a.ballB.position.y,a.arMgC.position.x=a.ballC.position.x+.8,a.arMgC.position.y=a.ballC.position.y,a.arMgD.position.x=a.ballD.position.x+.8,a.arMgD.position.y=a.ballD.position.y,a.arMgA.position.z=a.arMgB.position.z=a.arMgC.position.z=a.arMgD.position.z=6,a.arMgA.setArrow(0,-10,0),a.arMgB.setArrow(0,-10,0),a.arMgC.setArrow(0,-10,0),a.arMgD.setArrow(0,-10,0),b=kk*(a.ballA.position.y-a.ballB.position.y-10-L0),a.arFkA.position.x=a.ballA.position.x+.8,a.arFkB.position.x=a.ballB.position.x+.8,a.arFkC.position.x=a.ballC.position.x-.8,a.arFkD.position.x=a.ballD.position.x-.8,a.arFkA.position.y=a.ballA.position.y-5,a.arFkB.position.y=a.ballB.position.y+5,a.arFkC.position.y=a.ballC.position.y-5,a.arFkD.position.y=a.ballD.position.y+5,a.arFkA.position.z=a.arFkB.position.z=a.arFkC.position.z=a.arFkD.position.z=6,a.arFkA.setArrow(0,-b*d,0),a.arFkB.setArrow(0,b*d,0),a.arFkC.setArrow(0,-10,0),a.arFkD.setArrow(0,10,0),a.arTUR.position.x=a.ballC.position.x,a.arTUL.position.x=a.ballA.position.x,a.arTUR.position.y=a.ballC.position.y+5,a.arTUL.position.y=a.ballA.position.y+5,a.arTUR.position.z=a.arTUL.position.z=6,a.arTUR.setArrow(0,20,0),a.arTUL.setArrow(0,20,0),a.arAccA.position.x=a.ballA.position.x-10,a.arAccA.position.y=a.ballA.position.y,a.arAccB.position.x=a.ballB.position.x-10,a.arAccB.position.y=a.ballB.position.y,a.arAccC.position.x=a.ballC.position.x+10,a.arAccC.position.y=a.ballC.position.y,a.arAccD.position.x=a.ballD.position.x+10,a.arAccD.position.y=a.ballD.position.y;let e=world2D.chSlow.checked?1:10;a.arAccA.setArrow(0,(a.ballA.vy-a.ballA.vyOld)/(dt*e),0),a.arAccB.setArrow(0,(a.ballB.vy-a.ballB.vyOld)/(dt*e),0),a.arAccC.setArrow(0,(a.ballC.vy-a.ballC.vyOld)/(dt*e),0),a.arAccD.setArrow(0,(a.ballD.vy-a.ballD.vyOld)/(dt*e),0),a.ballA.vyOld=a.ballA.vy,a.ballB.vyOld=a.ballB.vy,a.ballC.vyOld=a.ballC.vy,a.ballD.vyOld=a.ballD.vy,a.labelMgA.position.y=a.arMgA.position.y-5,a.labelMgA.position.x=a.arMgA.position.x-6,a.labelMgB.position.y=a.arMgB.position.y-5,a.labelMgB.position.x=a.arMgB.position.x-6,a.labelMgC.position.y=a.arMgC.position.y-5,a.labelMgC.position.x=a.arMgC.position.x+6,a.labelMgD.position.y=a.arMgD.position.y-5,a.labelMgD.position.x=a.arMgD.position.x+6,a.labelFkA.position.y=a.arFkA.position.y-.5*b*d,a.labelFkA.position.x=a.arFkA.position.x+6,a.labelFkB.position.y=a.arFkB.position.y+.5*b*d,a.labelFkB.position.x=a.arFkB.position.x+6,a.labelFkC.position.y=a.arFkC.position.y-5,a.labelFkC.position.x=a.arFkC.position.x-6,a.labelFkD.position.y=a.arFkD.position.y+5,a.labelFkD.position.x=a.arFkD.position.x-6,a.labelTUL.position.y=a.arTUL.position.y+.5*a.arTUL.y,a.labelTUL.position.x=a.arTUL.position.x-5,a.labelTUR.position.y=a.arTUR.position.y+.5*a.arTUR.y,a.labelTUR.position.x=a.arTUR.position.x+5,a.labelAccA.position.y=a.arAccA.position.y+.5*a.arAccA.y,a.labelAccA.position.x=a.arAccA.position.x-5,a.labelAccB.position.y=a.arAccB.position.y+.5*a.arAccB.y;a.labelAccB.position.x=a.arAccB.position.x-5,a.labelAccC.position.y=a.arAccC.position.y+.5*a.arAccC.y;a.labelAccC.position.x=a.arAccC.position.x+5,a.labelAccD.position.y=a.arAccD.position.y+.5*a.arAccD.y;a.labelAccD.position.x=a.arAccD.position.x+5;let f=world2D.chArrowA.checked,g=world2D.chArrowF.checked;a.arMgA.visible=a.arMgB.visible=a.arMgC.visible=a.arMgD.visible=a.arFkA.visible=a.arFkB.visible=a.arFkC.visible=a.arFkD.visible=a.arTUR.visible=a.arTUL.visible=g,a.labelMgA.visible=a.labelMgB.visible=a.labelMgC.visible=a.labelMgD.visible=a.labelFkA.visible=a.labelFkB.visible=g,a.labelFkC.visible=a.labelFkD.visible=a.labelTUR.visible=a.labelTUL.visible=a.arFkC.visible=a.arFkD.visible=a.arTUR.visible=a.arTUL.visible=0===gameMD&&g,a.arAccA.visible=a.arAccB.visible=a.arAccC.visible=a.arAccD.visible=a.labelAccA.visible=a.labelAccB.visible=a.labelAccC.visible=a.labelAccD.visible=f,a.scissorsR.position.y=a.ballC.position.y+15,a.scissorsL.position.y=a.ballA.position.y+15,a.scissorsR.position.x=a.ballC.position.x+4,a.scissorsL.position.x=a.ballA.position.x+4,a.scissorsL.rotY.rotation.y=a.scissorsR.rotY.rotation.y=Math.PI/5,a.scissorsL.rotation.z=a.scissorsR.rotation.z=Math.PI/2,0===gameMD?(a.scissorsR.resetScissors(),a.scissorsL.resetScissors()):(a.scissorsR.updateScissors(),a.scissorsL.updateScissors()),world2D.chFollow.checked&&1>cameraFollowRatio?(cameraFollowRatio+=.01,1<cameraFollowRatio&&(cameraFollowRatio=1)):!world2D.chFollow.checked&&0<cameraFollowRatio&&(cameraFollowRatio-=.01,0>cameraFollowRatio&&(cameraFollowRatio=0)),world3D.cameraTarget.y=.5*(a.ballA.position.y+a.ballB.position.y)*cameraFollowRatio+957.5*(1-cameraFollowRatio)}}class WorldB extends THREE.Object3D{constructor(){super();let a=this;a.ballA=new TEACHER.ObjBox(10,10,10,65535),a.ballB=new TEACHER.ObjBox(10,10,10,52224),a.spring=new TEACHER.ObjSpring(L0,3,.3,8,16776960),a.wireL=new TEACHER.ObjCylinder(.5,20,16750848),a.ballA.position.x=a.ballB.position.x=a.wireL.position.x=a.spring.position.x=-15,a.add(a.ballA).add(a.ballB).add(a.spring).add(a.wireL),a.ballC=new TEACHER.ObjBox(10,10,10,65535),a.ballD=new TEACHER.ObjBox(10,10,10,52224),a.wireM=new TEACHER.ObjCylinder(.5,20,16750848),a.wireR=new TEACHER.ObjCylinder(.5,20,16750848),a.wireR.position.y=90,a.ballC.position.x=a.ballD.position.x=a.wireM.position.x=a.wireR.position.x=x0,a.add(a.ballC).add(a.ballD).add(a.wireM).add(a.wireR);let b=new TEACHER.ObjBox(100,5,20,10053120);b.position.y=100+2.5,a.add(b);for(var c,d=0;1>d;d++)c=new Ground,c.position.y=100*d+50,c.position.z=-5,a.add(c);a.arMgL=new TEACHER.ObjArrow(1.5,16777215),a.arMgR=new TEACHER.ObjArrow(1.5,16777215),a.arFkL=new TEACHER.ObjArrow(1.5,16750848),a.arFkR=new TEACHER.ObjArrow(1.5,16750848),a.arTUL=new TEACHER.ObjArrow(1.5,16776960),a.arTUR=new TEACHER.ObjArrow(1.5,16750848),a.arAccL=new TEACHER.ObjArrow(1.5,16737894),a.arAccR=new TEACHER.ObjArrow(1.5,16737894),a.add(a.arAccL).add(a.arAccR).add(a.arMgL).add(a.arMgR).add(a.arFkL).add(a.arFkR).add(a.arTUR).add(a.arTUL),a.labelMgR=new TexturePlane(100,100,"textureAll",1),a.labelMgR.textureGotoAndStop(0),a.labelMgL=new TexturePlane(100,100,"textureAll",1),a.labelMgL.textureGotoAndStop(0),a.labelMgR.scale.x=a.labelMgR.scale.y=a.labelMgL.scale.x=a.labelMgL.scale.y=.08,a.labelFkR=new TexturePlane(100,100,"textureAll",1),a.labelFkR.textureGotoAndStop(1),a.labelFkL=new TexturePlane(100,100,"textureAll",1),a.labelFkL.textureGotoAndStop(1),a.labelFkR.scale.x=a.labelFkR.scale.y=a.labelFkL.scale.x=a.labelFkL.scale.y=.08,a.labelTUL=new TexturePlane(100,100,"textureAll",1),a.labelTUL.textureGotoAndStop(2),a.labelTUR=new TexturePlane(100,100,"textureAll",1),a.labelTUR.textureGotoAndStop(1),a.labelTUR.scale.x=a.labelTUR.scale.y=a.labelTUL.scale.x=a.labelTUL.scale.y=.08,a.labelAccR=new TexturePlane(100,100,"textureAll",1),a.labelAccR.textureGotoAndStop(3),a.labelAccL=new TexturePlane(100,100,"textureAll",1),a.labelAccL.textureGotoAndStop(3),a.labelAccR.scale.x=a.labelAccR.scale.y=a.labelAccL.scale.x=a.labelAccL.scale.y=.08,a.add(a.labelMgR).add(a.labelMgL).add(a.labelFkR).add(a.labelFkL).add(a.labelAccR).add(a.labelAccL).add(a.labelTUR).add(a.labelTUL),a.arMgR.position.z=a.arMgL.position.z=a.arFkR.position.z=a.arFkL.position.z=a.arTUR.position.z=a.arTUL.position.z=6,a.arAccR.position.z=a.arAccL.position.z=0,a.labelMgR.position.z=a.labelMgL.position.z=a.labelFkR.position.z=a.labelFkL.position.z=a.labelTUR.position.z=a.labelTUL.position.z=6,a.labelAccR.position.z=a.labelAccL.position.z=0,a.scissorsL=new Scissors,a.scissorsR=new Scissors,a.add(a.scissorsR).add(a.scissorsL),a.resetGame()}resetGame(){let a=this;a.ballA.position.y=100-L0-5-100/kk,a.ballB.position.y=a.ballA.position.y-20-10,a.wireL.position.y=a.ballA.position.y-5-10,a.ballA.vy=a.ballB.vy=0,a.ballA.vyOld=0,a.ballC.position.y=75,a.ballD.position.y=45,a.wireM.position.y=a.ballC.position.y-5-10,a.ballC.vy=a.ballD.vy=0,a.ballC.vyOld=0}update(){let a=this;if(0===gameMD)a.resetGame();else if(1===gameMD){let d=world2D.chSlow.checked?1:10;for(var b,c=0;c<d;c++)b=kk*(a.ballA.position.y-(100-L0)),a.ballA.vy-=(b/mm+gg)*dt,a.ballB.vy-=gg*dt,a.ballA.position.y+=a.ballA.vy*dt,a.ballB.position.y+=a.ballB.vy*dt,5>a.ballB.position.y&&0>a.ballB.vy&&(a.ballB.position.y=5,a.ballB.vy*=-.5),a.ballD.vy-=gg*dt,a.ballD.position.y+=a.ballD.vy*dt,5>a.ballD.position.y&&(a.ballD.position.y=5,a.ballD.vy*=-.5)}a.spring.position.y=100,a.spring.setSpring(0,a.ballA.position.y-100+5,0),a.wireL.visible=a.wireM.visible=0===gameMD,a.wireM.position.y=a.ballC.position.y-5-10;let d=.2;a.arMgL.position.x=a.ballA.position.x-1,a.arMgL.position.y=a.ballA.position.y,a.arMgR.position.x=a.ballC.position.x+1,a.arMgR.position.y=a.ballC.position.y,a.arFkL.position.x=a.ballA.position.x+1,a.arFkL.position.y=a.ballA.position.y-5,a.arFkR.position.x=a.ballC.position.x-1,a.arFkR.position.y=a.ballC.position.y-5,a.arTUL.position.x=a.ballA.position.x,a.arTUL.position.y=a.ballA.position.y+5,a.arTUR.position.x=a.ballC.position.x,a.arTUR.position.y=a.ballC.position.y+5,a.arMgL.setArrow(0,-10,0),a.arMgR.setArrow(0,-10,0),a.arFkL.setArrow(0,-10,0),a.arFkR.setArrow(0,-10,0);var b=kk*(a.ballA.position.y-(100-L0));a.arTUL.setArrow(0,-b*d,0),a.arTUR.setArrow(0,(0===gameMD?2:1)*mm*gg*d,0),a.arAccL.position.x=a.ballA.position.x-10,a.arAccL.position.y=a.ballA.position.y,a.arAccR.position.x=a.ballC.position.x+10,a.arAccR.position.y=a.ballC.position.y;let e=world2D.chSlow.checked?1:10;a.arAccL.setArrow(0,(a.ballA.vy-a.ballA.vyOld)/(dt*e),0),a.arAccR.setArrow(0,(a.ballC.vy-a.ballC.vyOld)/(dt*e),0),a.ballA.vyOld=a.ballA.vy,a.ballC.vyOld=a.ballC.vy,a.labelMgL.position.y=a.arMgL.position.y-5,a.labelMgL.position.x=a.arMgL.position.x-6,a.labelMgR.position.y=a.arMgR.position.y-5,a.labelMgR.position.x=a.arMgR.position.x+6,a.labelFkL.position.y=a.arFkL.position.y-5,a.labelFkL.position.x=a.arFkL.position.x+6,a.labelFkR.position.y=a.arFkR.position.y-5,a.labelFkR.position.x=a.arFkR.position.x-6,a.labelTUL.position.y=a.arTUL.position.y+.5*a.arTUL.y,a.labelTUL.position.x=a.arTUL.position.x-5,a.labelTUR.position.y=a.arTUR.position.y+.5*a.arTUR.y,a.labelTUR.position.x=a.arTUR.position.x+5,a.labelAccL.position.y=a.arAccL.position.y+.5*a.arAccL.y,a.labelAccL.position.x=a.arAccL.position.x-5,a.labelAccR.position.y=a.arAccR.position.y+.5*a.arAccR.y;a.labelAccR.position.x=a.arAccR.position.x+5;let f=world2D.chArrowA.checked,g=world2D.chArrowF.checked;a.arMgL.visible=a.arMgR.visible=a.arTUR.visible=a.arTUL.visible=g,a.arFkL.visible=a.arFkR.visible=0===gameMD&&g,a.labelMgL.visible=a.labelMgR.visible=a.labelTUR.visible=a.labelTUL.visible=g,a.labelFkL.visible=a.labelFkR.visible=0===gameMD&&g,a.arAccL.visible=a.arAccR.visible=a.labelAccL.visible=a.labelAccR.visible=f,a.scissorsR.position.y=a.ballC.position.y-15,a.scissorsL.position.y=a.ballA.position.y-15,a.scissorsR.position.x=a.ballC.position.x+4,a.scissorsL.position.x=a.ballA.position.x+4,a.scissorsL.rotY.rotation.y=a.scissorsR.rotY.rotation.y=Math.PI/5,a.scissorsL.rotation.z=a.scissorsR.rotation.z=Math.PI/2,0===gameMD?(a.scissorsR.resetScissors(),a.scissorsL.resetScissors()):(a.scissorsR.updateScissors(),a.scissorsL.updateScissors()),world2D.chFollow.checked&&1>cameraFollowRatio?(cameraFollowRatio+=.01,1<cameraFollowRatio&&(cameraFollowRatio=1)):!world2D.chFollow.checked&&0<cameraFollowRatio&&(cameraFollowRatio-=.01,0>cameraFollowRatio&&(cameraFollowRatio=0)),world3D.cameraTarget.y=55}}class WorldC extends THREE.Object3D{constructor(){super();let a=this;a.ballL=new TEACHER.ObjSphere(5,65535),a.ballR=new TEACHER.ObjSphere(5,65535),a.spring=new TEACHER.ObjSpring(L0,3,.3,8,16776960),a.wireBig=new THREE.Object3D;let b=new TEACHER.ObjCylinder(.5,2*L0-5,16750848);b.position.y=-L0+2.5,a.wireBig.add(b),a.ballL.position.x=-1.5*x0+L0,a.ballL.position.y=100-L0*Math.sqrt(3),a.ballR.position.x=1.5*x0+L0,a.ballR.position.y=100-L0*Math.sqrt(3),a.wireBig.position.x=1.5*x0,a.wireBig.position.y=100,a.wireBig.rotation.z=30*Math.PI/180,a.spring.position.x=-1.5*x0,a.spring.position.y=100,a.add(a.ballL).add(a.ballR).add(a.spring).add(a.wireBig),a.wireBig.theta=30*Math.PI/180,a.wireBig.omega=0,a.wireHR=new TEACHER.ObjCylinder(.5,20,16750848,!1,"x"),a.wireHL=new TEACHER.ObjCylinder(.5,20,16750848,!1,"x"),a.wireHR.position.x=1.5*x0+L0+10,a.wireHL.position.x=-1.5*x0+L0+10,a.wireHL.position.y=a.wireHR.position.y=100-L0*Math.sqrt(3),a.add(a.wireHR).add(a.wireHL),a.wallHR=new TEACHER.ObjBox(5,10,10,10053120),a.wallHL=new TEACHER.ObjBox(5,10,10,10053120),a.wallHR.position.x=1.5*x0+L0+20+2.5,a.wallHL.position.x=-1.5*x0+L0+20+2.5,a.wallHL.position.y=a.wallHR.position.y=100-L0*Math.sqrt(3),a.add(a.wallHR).add(a.wallHL);let c=new TEACHER.ObjBox(120,5,20,10053120);c.position.y=100+2.5,a.add(c);for(var d,e=0;1>e;e++)d=new Ground,d.position.y=100*e+50,d.position.z=-5,a.add(d);a.arMgL=new TEACHER.ObjArrow(1.5,16777215),a.arMgR=new TEACHER.ObjArrow(1.5,16777215),a.arFkL=new TEACHER.ObjArrow(1.5,16750848),a.arFkR=new TEACHER.ObjArrow(1.5,16750848),a.arTUL=new TEACHER.ObjArrow(1.5,16776960),a.arTUR=new TEACHER.ObjArrow(1.5,16750848),a.arAccL=new TEACHER.ObjArrow(1.5,16737894),a.arAccR=new TEACHER.ObjArrow(1.5,16737894),a.add(a.arAccL).add(a.arAccR).add(a.arMgL).add(a.arMgR).add(a.arFkL).add(a.arFkR).add(a.arTUR).add(a.arTUL),a.labelMgR=new TexturePlane(100,100,"textureAll",1),a.labelMgR.textureGotoAndStop(0),a.labelMgL=new TexturePlane(100,100,"textureAll",1),a.labelMgL.textureGotoAndStop(0),a.labelMgR.scale.x=a.labelMgR.scale.y=a.labelMgL.scale.x=a.labelMgL.scale.y=.08,a.labelFkR=new TexturePlane(100,100,"textureAll",1),a.labelFkR.textureGotoAndStop(1),a.labelFkL=new TexturePlane(100,100,"textureAll",1),a.labelFkL.textureGotoAndStop(1),a.labelFkR.scale.x=a.labelFkR.scale.y=a.labelFkL.scale.x=a.labelFkL.scale.y=.08,a.labelTUL=new TexturePlane(100,100,"textureAll",1),a.labelTUL.textureGotoAndStop(2),a.labelTUR=new TexturePlane(100,100,"textureAll",1),a.labelTUR.textureGotoAndStop(1),a.labelTUR.scale.x=a.labelTUR.scale.y=a.labelTUL.scale.x=a.labelTUL.scale.y=.08,a.labelAccR=new TexturePlane(100,100,"textureAll",1),a.labelAccR.textureGotoAndStop(3),a.labelAccL=new TexturePlane(100,100,"textureAll",1),a.labelAccL.textureGotoAndStop(3),a.labelAccR.scale.x=a.labelAccR.scale.y=a.labelAccL.scale.x=a.labelAccL.scale.y=.08,a.add(a.labelMgR).add(a.labelMgL).add(a.labelFkR).add(a.labelFkL).add(a.labelAccR).add(a.labelAccL).add(a.labelTUR).add(a.labelTUL),a.arMgR.position.z=a.arMgL.position.z=a.arFkR.position.z=a.arFkL.position.z=a.arTUR.position.z=a.arTUL.position.z=2,a.arAccR.position.z=a.arAccL.position.z=6,a.labelMgR.position.z=a.labelMgL.position.z=a.labelFkR.position.z=a.labelFkL.position.z=a.labelTUR.position.z=a.labelTUL.position.z=5,a.labelAccR.position.z=a.labelAccL.position.z=9,a.scissorsL=new Scissors,a.scissorsR=new Scissors,a.add(a.scissorsR).add(a.scissorsL),a.resetGame()}resetGame(){let a=this;a.ballL.position.x=-1.5*x0+L0,a.ballL.position.y=100-L0*Math.sqrt(3),a.ballR.position.x=1.5*x0+L0,a.ballR.position.y=100-L0*Math.sqrt(3),a.wireBig.position.x=1.5*x0,a.wireBig.position.y=100,a.wireBig.rotation.z=30*Math.PI/180,a.spring.position.x=-1.5*x0,a.spring.position.y=100;let b=2*L0-5,c=30*Math.PI/180;a.spring.setSpring(b*Math.sin(c),-b*Math.cos(c),0),a.ballL.vx=a.ballL.vy=0,a.ballR.vx=a.ballR.vy=0,a.ballL.vxOld=a.ballL.vyOld=0,a.ballR.vxOld=a.ballR.vyOld=0,a.wireBig.theta=c,a.wireBig.omega=0,a.ballL.vx=a.ballL.vy=0}update(){let a=this,b=2*L0-100/Math.sqrt(3)/kk;if(0===gameMD)a.resetGame();else if(1===gameMD){let d=world2D.chSlow.checked?1:10;for(var c=0;c<d;c++){let c=-5/2/L0*Math.sin(a.wireBig.theta);a.wireBig.omega+=c*dt,a.wireBig.theta+=a.wireBig.omega*dt,a.wireBig.rotation.z=a.wireBig.theta,a.ballR.position.x=1.5*x0+2*L0*Math.sin(a.wireBig.theta),a.ballR.position.y=100-2*L0*Math.cos(a.wireBig.theta),a.ballR.vx=2*L0*a.wireBig.omega*Math.cos(a.wireBig.theta),a.ballR.vy=2*L0*a.wireBig.omega*Math.sin(a.wireBig.theta);let d=a.ballL.position.x+1.5*x0,e=a.ballL.position.y-100,f=d**2+e**2;f=Math.sqrt(f);let g=-kk*(f-b)*d/f,h=-kk*(f-b)*e/f;a.ballL.vx+=g/mm*dt,a.ballL.vy+=(h/mm-gg)*dt,a.ballL.position.x+=a.ballL.vx*dt,a.ballL.position.y+=a.ballL.vy*dt}}a.wireHR.visible=a.wireHL.visible=a.wallHR.visible=a.wallHL.visible=0===gameMD,a.spring.position.y=100,a.spring.position.x=-1.5*x0;let d=a.ballL.position.x+1.5*x0,e=a.ballL.position.y-100,f=d**2+e**2;f=Math.sqrt(f);let g=Math.atan2(d,e);a.spring.setSpring(0,f-5,0),a.spring.rotation.z=-g;let h=.2;a.arMgL.position.x=a.ballL.position.x,a.arMgL.position.y=a.ballL.position.y-5,a.arMgR.position.x=a.ballR.position.x,a.arMgR.position.y=a.ballR.position.y-5,a.arMgL.setArrow(0,-10,0),a.arMgR.setArrow(0,-10,0),a.arFkL.position.x=a.ballL.position.x+5,a.arFkL.position.y=a.ballL.position.y,a.arFkR.position.x=a.ballR.position.x+5,a.arFkR.position.y=a.ballR.position.y,a.arFkL.setArrow(10*Math.tan(30*Math.PI/180),0,0),a.arFkR.setArrow(10*Math.tan(30*Math.PI/180),0,0),d=a.ballR.position.x-1.5*x0,e=a.ballR.position.y-100,f=d**2+e**2,f=Math.sqrt(f);let i=0===gameMD?-50/Math.cos(30*Math.PI/180):-20*L0*a.wireBig.omega**2+50*e/f;a.arTUR.position.x=a.ballR.position.x-5*d/f,a.arTUR.position.y=a.ballR.position.y-5*e/f,a.arTUR.setArrow(d/f*i*h,e/f*i*h,0),d=a.ballL.position.x+1.5*x0,e=a.ballL.position.y-100,f=d**2+e**2,f=Math.sqrt(f);let k=-kk*(f-b)*d/f,l=-kk*(f-b)*e/f;a.arTUL.position.x=a.ballL.position.x-5*d/f,a.arTUL.position.y=a.ballL.position.y-5*e/f,a.arTUL.setArrow(k*h,l*h,0),a.arAccL.position.x=a.ballL.position.x,a.arAccL.position.y=a.ballL.position.y,a.arAccR.position.x=a.ballR.position.x,a.arAccR.position.y=a.ballR.position.y;let m=world2D.chSlow.checked?1:10;a.arAccL.setArrow(3*(a.ballL.vx-a.ballL.vxOld)/(dt*m),3*(a.ballL.vy-a.ballL.vyOld)/(dt*m),0),a.arAccR.setArrow(3*(a.ballR.vx-a.ballR.vxOld)/(dt*m),3*(a.ballR.vy-a.ballR.vyOld)/(dt*m),0),a.ballL.vxOld=a.ballL.vx,a.ballL.vyOld=a.ballL.vy,a.ballR.vxOld=a.ballR.vx,a.ballR.vyOld=a.ballR.vy,a.labelMgL.position.y=a.arMgL.position.y-8,a.labelMgL.position.x=a.arMgL.position.x,a.labelMgR.position.y=a.arMgR.position.y-8,a.labelMgR.position.x=a.arMgR.position.x,a.labelFkL.position.y=a.arFkL.position.y,a.labelFkL.position.x=a.arFkL.position.x+6,a.labelFkR.position.y=a.arFkR.position.y,a.labelFkR.position.x=a.arFkR.position.x+6,a.labelTUL.position.y=a.arTUL.position.y+a.arTUL.y,a.labelTUL.position.x=a.arTUL.position.x+a.arTUL.x,a.labelTUR.position.y=a.arTUR.position.y+a.arTUR.y,a.labelTUR.position.x=a.arTUR.position.x+a.arTUR.x,a.labelAccL.position.y=a.arAccL.position.y+.5*a.arAccL.y,a.labelAccL.position.x=a.arAccL.position.x-8,a.labelAccR.position.y=a.arAccR.position.y+.5*a.arAccR.y;a.labelAccR.position.x=a.arAccR.position.x-8;let n=world2D.chArrowA.checked,o=world2D.chArrowF.checked;a.arMgL.visible=a.arMgR.visible=a.arTUR.visible=a.arTUL.visible=o,a.arFkL.visible=a.arFkR.visible=0===gameMD&&o,a.labelMgL.visible=a.labelMgR.visible=a.labelTUR.visible=a.labelTUL.visible=o,a.labelFkL.visible=a.labelFkR.visible=0===gameMD&&o,a.arAccL.visible=a.arAccR.visible=a.labelAccL.visible=a.labelAccR.visible=n,a.scissorsR.position.y=a.ballR.position.y-3,a.scissorsL.position.y=a.ballL.position.y-3,a.scissorsR.position.x=a.ballR.position.x+12,a.scissorsL.position.x=a.ballL.position.x+12,a.scissorsL.rotY.rotation.y=a.scissorsR.rotY.rotation.y=-Math.PI/5,0===gameMD?(a.scissorsR.resetScissors(),a.scissorsL.resetScissors()):(a.scissorsR.updateScissors(),a.scissorsL.updateScissors()),world2D.chFollow.checked&&1>cameraFollowRatio?(cameraFollowRatio+=.01,1<cameraFollowRatio&&(cameraFollowRatio=1)):!world2D.chFollow.checked&&0<cameraFollowRatio&&(cameraFollowRatio-=.01,0>cameraFollowRatio&&(cameraFollowRatio=0)),world3D.cameraTarget.y=55}}var TexturePlane=class extends THREE.Object3D{constructor(a,b,c,d){super();let e=this;e.ss=d||1,e.w=a,e.h=b,e.canvas=document.createElement("canvas"),e.canvas.width=e.w*e.ss,e.canvas.height=e.h*e.ss,e.stage=new createjs.Stage(e.canvas),e.eTexture=new lib[c],e.eTexture.scaleX=e.eTexture.scaleY=e.ss,e.stage.addChild(e.eTexture),e.stage.update(),e.mapTexture=new THREE.Texture(e.canvas),e.mapTexture.needsUpdate=!0,e.mapMaterial=new THREE.MeshStandardMaterial({map:e.mapTexture,side:0,roughness:.4,transparent:!0}),e.mesh=new THREE.Mesh(new THREE.PlaneGeometry(e.w,e.h,1,1),e.mapMaterial),e.add(e.mesh)}textureGotoAndStop(a){let b=this;b.eTexture.gotoAndStop(a),b.stage.update(),b.mapTexture.needsUpdate=!0}};class Scissors extends THREE.Object3D{constructor(){super();let a=this;a.rotY=new THREE.Object3D,a.add(a.rotY),a.scissorsR=new THREE.Object3D,a.scissorsL=new THREE.Object3D,a.rotY.add(a.scissorsR).add(a.scissorsL);let b=new TEACHER.ObjCylinder(.5,10,16776960,!1,"y"),c=new TEACHER.ObjCylinder(.5,10,16776960,!1,"y");b.scale.z=c.scale.z=.2,b.position.y=c.position.y=1.5;let d=new TEACHER.ObjCylinder(1.5,1,16776960,!1,"z"),e=new TEACHER.ObjCylinder(1.5,1,16776960,!1,"z");e.position.x=-1.1,d.position.x=+1.1,e.position.y=d.position.y=-2.3,a.scissorsR.add(b).add(d),a.scissorsL.add(c).add(e),a.scissorsR.rotation.z=20*Math.PI/180,a.scissorsL.rotation.z=-20*Math.PI/180,a.scissorsTime=20}resetScissors(){let a=this;a.scissorsTime=20,a.scissorsR.rotation.z=20*Math.PI/180,a.scissorsL.rotation.z=-20*Math.PI/180,a.visible=!0}updateScissors(){let a=this;a.scissorsTime-=2,a.scissorsR.rotation.z=a.scissorsTime*Math.PI/180,a.scissorsL.rotation.z=-a.scissorsTime*Math.PI/180,a.visible=5<a.scissorsTime}}class Ground extends THREE.Object3D{constructor(){super();let a=this,b=new THREE.PlaneGeometry(10,10,1,1),c=new TEACHER.MSMat(10066329),d=new TEACHER.MSMat(6710886);for(var e=0;10>e;e++)for(var f=0;10>f;f++){let g=new THREE.Mesh(b,0==(e%2+f%2)%2?c:d);g.position.x=-45+10*f,g.position.y=-45+10*e,a.add(g)}}}var TEACHER={};TEACHER.ObjPlane=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this;f.mat=new TEACHER.MSMat(c,e),f.geo=new THREE.PlaneGeometry(a||10,b||10,1,1),f.mesh=new THREE.Mesh(f.geo,f.mat),"x"===d?f.mesh.rotation.y=.5*Math.PI:"y"==d&&(f.mesh.rotation.x=-.5*Math.PI),f.add(f.mesh)}},TEACHER.ObjCylinder=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this;g.mat=new TEACHER.MSMat(c,f),g.geo=new THREE.CylinderGeometry(a||10,a||10,b||10,32,2,d),g.mesh=new THREE.Mesh(g.geo,g.mat),"x"===e?g.mesh.rotation.z=-.5*Math.PI:"z"==e&&(g.mesh.rotation.x=.5*Math.PI),g.add(g.mesh)}},TEACHER.ObjSphere=class extends THREE.Object3D{constructor(a,b,c){super();let d=this;d.mat=new TEACHER.MSMat(b,c),d.geo=new THREE.SphereGeometry(a||10,32,16),d.mesh=new THREE.Mesh(d.geo,d.mat),d.add(d.mesh)}},TEACHER.ObjBox=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this;f.mat=new TEACHER.MSMat(d,e),f.geo=new THREE.BoxGeometry(a||10,b||10,c||10),f.mesh=new THREE.Mesh(f.geo,f.mat),f.add(f.mesh)}},TEACHER.MSMat=class extends THREE.MeshStandardMaterial{constructor(a,b){super({color:a||16711935,roughness:.4,side:b||0})}},TEACHER.ObjPicPlane=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=this,g=new THREE.TextureLoader().load(c);f.mat=new THREE.MeshBasicMaterial({map:g,transparent:!0,side:e||0}),f.geo=new THREE.PlaneGeometry(a,b,1,1),f.mesh=new THREE.Mesh(f.geo,f.mat),"x"===d?f.mesh.rotation.y=.5*Math.PI:"y"==d&&(f.mesh.rotation.x=-.5*Math.PI),f.add(f.mesh)}},TEACHER.ObjPicCylinder=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this,h=new THREE.TextureLoader().load(c);g.mat=new THREE.MeshBasicMaterial({map:h,side:f||0}),g.geo=new THREE.CylinderGeometry(a||10,a||10,b||10,32,4,d),g.mesh=new THREE.Mesh(g.geo,g.mat),"x"===e?g.mesh.rotation.z=-.5*Math.PI:"z"===e?(g.mesh.rotation.y=.5*Math.PI,g.mesh.rotation.x=.5*Math.PI):"y"==e&&(g.mesh.rotation.y=.5*Math.PI),g.add(g.mesh)}},TEACHER.ObjPicSphere=class extends THREE.Object3D{constructor(a,b,c){super();let d=this,e=new THREE.TextureLoader().load(b);d.mat=new THREE.MeshBasicMaterial({map:e,side:c||0}),d.geo=new THREE.SphereGeometry(a||10,32,16),d.mesh=new THREE.Mesh(d.geo,d.mat),d.add(d.mesh)}},TEACHER.ObjArrow=class extends THREE.Object3D{constructor(a,b){super();let c=.5,d=new THREE.MeshStandardMaterial({color:b||16711935,roughness:.4}),e=new THREE.ConeGeometry(a||10,40,32);this.ArrowHead=new THREE.Mesh(e,d),this.ArrowHead.position.y=80,e=new THREE.CylinderGeometry((a||10)*c,(a||10)*c,60,32,2),this.ArrowBody=new THREE.Mesh(e,d),this.ArrowBody.position.y=30,this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.ArrowBody),this.rotX.add(this.ArrowHead)}setArrow(a,b,c){let d=this;this.x=0===a?1e-5:a,this.y=0===b?.001:b,this.z=0===c?1e-5:c;let e=d.x**2+d.y**2+d.z**2,f=Math.sqrt(e);0<e&&(this.rotX.visible=!0,this.rotX.scale.y=f/100),this.rotX.rotation.x=Math.acos(d.y/f),this.rotY.rotation.y=Math.atan2(d.x,d.z)}},TEACHER.ObjSpring=class extends THREE.Object3D{constructor(a,b,c,d,e){super();let f=a||20;this.L0=f;let g=[],h=d||5,j=b||5;g.push(new THREE.Vector3(0,0,0)),g.push(new THREE.Vector3(0,.05*f,0));for(var k=0;k<=16*h;k++)g.push(new THREE.Vector3(j*Math.cos(2*k*Math.PI/16),f*(.05+.9*k/h/16),j*Math.sin(2*k*Math.PI/16)));g.push(new THREE.Vector3(0,.95*f,0)),g.push(new THREE.Vector3(0,f,0));let l=new THREE.CatmullRomCurve3(g),m=new THREE.MeshStandardMaterial({color:e||16711935,roughness:.4}),n=new THREE.TubeGeometry(l,500,c||.5,12);this.mesh=new THREE.Mesh(n,m),this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.mesh)}setSpring(a,b,c){let d=a*a+b*b+c*c,e=Math.sqrt(d);0<d?(this.rotX.visible=!0,this.rotX.scale.y=e/this.L0):this.rotX.visible=!1,this.rotX.rotation.x=Math.acos(b/e),this.rotY.rotation.y=Math.atan2(a,c)}},TEACHER.Points=class extends THREE.Points{constructor(a,b,c){let d=new THREE.Color(a||16711935),e=new THREE.BufferGeometry,f=[];e.setAttribute("position",new THREE.Float32BufferAttribute(f,3)),e.computeBoundingSphere();let g=new THREE.PointsMaterial({size:b||1,map:TEACHER.Points.createCanvasMaterial("#"+d.getHexString(),64),transparent:!0,depthWrite:!1});super(e,g);let h=this;h.nnMax=c||1e4,h.nnNow=0,h.geometry=e,h.positions=f}static createCanvasMaterial(a,b){var c=document.createElement("canvas");c.width=c.height=b;var d=c.getContext("2d");d.imageSmoothingEnabled=!1;var e=new THREE.Texture(c),f=b/2;return d.beginPath(),d.arc(f,f,b/2-3,0,2*Math.PI,!1),d.closePath(),d.fillStyle=a,d.fill(),e.needsUpdate=!0,e}addPoint(a,b,c){let d=this;d.nnNow<d.nnMax?d.nnNow++:(log("TEACHER.Points \u5230\u9054\u6700\u5927\u9EDE\u6578"),d.positions.shift(),d.positions.shift(),d.positions.shift()),d.positions.push(a,b,c)}clear(){let a=this;a.positions=[],a.nnNow=0,a.update()}setPoint(a,b,c,d){let e=this;a>e.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u6700\u5927\u9EDE\u6578 nnMax"):a>e.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u73FE\u5728\u9EDE\u6578 nnNow"):(e.positions[3*a]=b,e.positions[3*a+1]=c,e.positions[3*a+2]=d)}getPoint(a){let b=this,c=new THREE.Vector3;return a>b.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u6700\u5927\u9EDE\u6578 nnMax"):a>b.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Points \u73FE\u5728\u9EDE\u6578 nnNow"):(c.x=b.positions[3*a],c.y=b.positions[3*a+1],c.z=b.positions[3*a+2]),c}update(){let a=this;a.geometry.setAttribute("position",new THREE.Float32BufferAttribute(a.positions,3)),a.geometry.computeBoundingSphere(),a.geometry.attributes.position.needsUpdate=!0}},TEACHER.Line=class extends THREE.Line2{constructor(a,b,c){let d=c||1e4;var e=new THREE.LineMaterial({color:a||16711935,linewidth:b||1});e.resolution.set(window.innerWidth,window.innerHeight);let f=new THREE.LineGeometry,g=new Float32Array(3*d);f.setPositions(g),super(f,e);let h=this;h.nnMax=d,h.lineWidth=b||1,h.nnNow=0,h.geometry=f,h.positions=g}addPoint(a,b,c){let d=this;if(d.nnNow<d.nnMax)d.nnNow++;else{log("TEACHER.Line \u5230\u9054\u6700\u5927\u9EDE\u6578");for(var e=0;e<d.nnMax-1;e++)d.positions[3*e]=d.positions[3*e+3],d.positions[3*e+1]=d.positions[3*e+4],d.positions[3*e+2]=d.positions[3*e+5]}for(var e=d.nnNow;e<=d.nnMax;e++)d.positions[3*(e-1)]=a,d.positions[3*(e-1)+1]=b,d.positions[3*(e-1)+2]=c}clear(){let a=this;a.positions=new Float32Array(3*a.nnMax);a.nnNow=0,a.update()}setPoint(a,b,c,d){let e=this;a>e.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u6700\u5927\u9EDE\u6578 nnMax"):a>e.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u73FE\u5728\u9EDE\u6578 nnNow"):(e.positions[3*a]=b,e.positions[3*a+1]=c,e.positions[3*a+2]=d)}getPoint(a){let b=this,c=new THREE.Vector3;return a>b.nnMax?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u6700\u5927\u9EDE\u6578 nnMax"):a>b.nnNow?log("\u8F38\u5165\u7684n\u503C\u5927\u65BCTEACHER.Line \u73FE\u5728\u9EDE\u6578 nnNow"):(c.x=b.positions[3*a],c.y=b.positions[3*a+1],c.z=b.positions[3*a+2]),c}update(){let a=this,b=a.getPoint(a.nnNow-1);for(var c=a.nnNow;c<=a.nnMax;c++)a.positions[3*c]=b.x,a.positions[3*c+1]=b.y,a.positions[3*c+2]=b.z;a.geometry.setPositions(a.positions)}},TEACHER.ObjTextPlane=class extends THREE.Object3D{constructor(a,b,c,d,e,f){super();let g=this,h=Math.round(Math.log2(a/b)),i=$("<canvas>").attr("width",128*Math.pow(2,h)+"").attr("height","128");g.stage=new createjs.Stage(i[0]);let j=new createjs.Container;if(f){let a=new createjs.Shape,b=new THREE.Color(f);a.graphics.c().f("#"+b.getHexString()).dr(0,0,128*Math.pow(2,h),128),j.addChild(a)}g.ctext=new createjs.Text;let k=new THREE.Color(e||16777215);g.ctext.color="#"+k.getHexString(),g.ctext.font="96px Arial",g.ctext.text=c||"",g.ctext.textAlign="center",g.ctext.textBaseline="middle",g.ctext.x=128*Math.pow(2,h)/2,g.ctext.y=64,j.addChild(g.ctext),g.stage.addChild(j),g.stage.update(),g.texture=new THREE.Texture(i[0]);var l=new THREE.MeshBasicMaterial({map:g.texture,transparent:!0}),m=new THREE.PlaneGeometry(a||10,b||10,1,1);g.texture.needsUpdate=!0,g.plane1=new THREE.Mesh(m,l),g.plane2=new THREE.Mesh(m,l),g.plane2.rotation.y=Math.PI;let n=new THREE.Object3D;n.add(g.plane1).add(g.plane2),"x"===d?n.rotation.y=.5*Math.PI:"y"==d&&(n.rotation.x=-.5*Math.PI),g.add(n)}setText(a){let b=this;b.ctext.text=a,b.stage.update(),b.texture.needsUpdate=!0}},TEACHER.ObjGraph=class extends THREE.Object3D{constructor(a,b,c,d,e,f,g){super();let h=this;h.objCon=new THREE.Object3D,h._xMin=a||0,h._xMax=b||10,h._yMin=c||0,h._yMax=d||10,h.divXN=5,h.divYN=4,h.frameMat=new THREE.LineBasicMaterial({color:e||16777215});for(var i=[],j=0;j<=h.divXN;j++)i.push(new THREE.Vector3(-50+20*j,0,0)),i.push(new THREE.Vector3(-50+20*j,50,0));for(var k=0;k<=h.divYN;k++)i.push(new THREE.Vector3(-50,12.5*k,0)),i.push(new THREE.Vector3(50,12.5*k,0));let l=new THREE.BufferGeometry().setFromPoints(i);h.frame=new THREE.LineSegments(l,h.frameMat),h.objCon.add(h.frame),h.labelXMin=new TEACHER.ObjTextPlane(20,5,h._xMin+"","z",e||16777215),h.labelXMin.position.x=-50,h.labelXMin.position.y=-3,h.objCon.add(h.labelXMin),h.labelXMax=new TEACHER.ObjTextPlane(20,5,h._xMax+"","z",e||16777215),h.labelXMax.position.x=50,h.labelXMax.position.y=-3,h.objCon.add(h.labelXMax),h.labelYMin=new TEACHER.ObjTextPlane(20,5,h._yMin+"","z",e||16777215),h.labelYMin.position.x=-53,h.labelYMin.position.y=0,h.objCon.add(h.labelYMin),h.labelYMax=new TEACHER.ObjTextPlane(20,5,h._yMax+"","z",e||16777215),h.labelYMax.position.x=-53,h.labelYMax.position.y=50,h.objCon.add(h.labelYMax),h.labelX=new TEACHER.ObjTextPlane(24,7,"x","z",e||16777215),h.labelX.position.x=60,h.labelX.position.y=4,h.labelX.position.z=1,h.labelY=new TEACHER.ObjTextPlane(24,7,"y","z",e||16777215),h.labelY.position.x=-60,h.labelY.position.y=25,h.labelY.position.z=1,h.labelY.rotation.z=Math.PI/2,h.labelTitle=new TEACHER.ObjTextPlane(40,10,"y-x","z",e||16777215),h.labelTitle.position.y=53,h.labelTitle.position.z=1,h.objCon.add(h.labelX).add(h.labelY).add(h.labelTitle),h._lineColor=f,h._nnMax=g,h.line=new TEACHER.Line(h._lineColor||16776960,2,h._nnMax),h.objCon.add(h.line),h.changeScale(),h.add(h.objCon)}addPoint(a,b){let c=this;c.line.addPoint(a,b,0),c.line.update()}clear(){let a=this;a.line.clear()}changeScale(){let a=this;a.line.scale.x=100/(a._xMax-a._xMin),a.line.scale.y=50/(a._yMax-a._yMin),a.line.position.x=-50-a._xMin*a.line.scale.x,a.line.position.y=-a._yMin*a.line.scale.y,a.labelXMin.setText(a._xMin),a.labelXMax.setText(a._xMax),a.labelYMin.setText(a._yMin),a.labelYMax.setText(a._yMax)}setLabel(a,b,c){let d=this;d.labelTitle.setText(a||"y-x"),d.labelY.setText(b||"y"),d.labelX.setText(c||"x")}get xMin(){return this._xMin}set xMin(a){this._xMin=a,this.changeScale()}get xMax(){return this._xMax}set xMax(a){this._xMax=a,this.changeScale()}get yMin(){return this._yMin}set yMin(a){this._yMin=a,this.changeScale()}get yMax(){return this._yMax}set yMax(a){this._yMax=a,this.changeScale()}};var skyBox=new THREE.Object3D;skyBox.wallU=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallU,"y",1),skyBox.wallD=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallD,"y",0),skyBox.wallS=new TEACHER.ObjPicCylinder(5e3,1e4,pics.wallSide,!0,"y",1),skyBox.wallU.position.y=5e3,skyBox.wallD.position.y=-5e3,skyBox.add(skyBox.wallU).add(skyBox.wallD).add(skyBox.wallS),world3D.scene.add(skyBox);var ground=new Ground;ground.rotation.x=-Math.PI/2,world3D.scene.add(ground);var logo=new TEACHER.ObjPicPlane(100,100/8,pics.logo,"z",2);logo.position.z=-50,logo.position.y=100/8/2,world3D.scene.add(logo);function getMouse3D(a){let b,c=a||"y",d=new THREE.Vector3;"x"===c?b=new THREE.Vector3(1,0,0):"y"===c?b=new THREE.Vector3(0,1,0):"z"===c?b=new THREE.Vector3(0,0,1):log("\u932F\u8AA4!!");let e=new THREE.Vector2;return e.x=2*(world2D.stage.mouseX/1600)-1,e.y=2*-(world2D.stage.mouseY/900)+1,world3D.raycaster.setFromCamera(e,world3D.camera),world3D.raycaster.ray.intersectPlane(new THREE.Plane(b),d),d}init();