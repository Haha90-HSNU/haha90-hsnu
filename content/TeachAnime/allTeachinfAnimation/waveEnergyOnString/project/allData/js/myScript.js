var fps=30,comp=AdobeAn.getComposition("98EA1A955B63F6489D0F00F6BFD1C4DE"),lib=comp.getLibrary(),myAnimate=new lib.myAnimate,canvas=$("<canvas>").attr("width","1600px").attr("height","900px");$("#mainAnimation").append(canvas);var stage=new createjs.Stage(canvas[0]);stage.enableMouseOver(1e3/fps),stage.addChild(myAnimate),createjs.Touch.enable(stage),stage.update();var waveC,coordEk,coordUs,coordEt,dx=1e3/24,lambda=12*dx,period=50,tt=0,dt=.2,amplitude=60,waveMD=1,isPlay=!0,isStep=!1,ballsD=[],ballsU=[],springsD=[],springsU=[],ballNN=25;function init(){myAnimate.helper.visible=!1,waveC=new createjs.Container,(coordEk=new lib.coordMC).gotoAndStop(0),(coordUs=new lib.coordMC).gotoAndStop(1),(coordEt=new lib.coordMC).gotoAndStop(2),waveC.x=coordEk.x=coordUs.x=coordEt.x=100,waveC.y=200,coordEk.y=550,coordUs.y=800,coordEt.y=675,myAnimate.addChild(waveC),myAnimate.addChild(coordEk),myAnimate.addChild(coordUs),myAnimate.addChild(coordEt);for(var a=0;a<ballNN;a++)(e=new lib.ball).scaleX=e.scaleY=.26,e.x=a*dx,waveC.addChild(e),ballsD.push(e),(o=new lib.box).x=e.x,waveC.addChild(o),springsD.push(o),o.visible=e.visible=!1;for(a=0;a<ballNN;a++)(i=new lib.box).x=a*dx,waveC.addChild(i),springsU.push(i),(t=new lib.ball).scaleX=t.scaleY=.2,t.x=a*dx,waveC.addChild(t),ballsU.push(t);stage.update();for(var e,t,o,a=0;a<ballNN;a++){(e=ballsD[a]).changeColor("#000000"),(t=ballsU[a]).changeColor("#FF0000"),(o=springsD[a]).changeColor("#FF0000");var i=springsU[a]}myAnimate.slDT.value=10,myAnimate.rbWave01.checked=!0,myAnimate.rbWave01.on("click",clickRBWave),myAnimate.rbWave02.on("click",clickRBWave),myAnimate.rbWave03.on("click",clickRBWave),myAnimate.btnPlayStop.on("click",clickPlayStop),myAnimate.btnStep.on("click",clickStep),setInterval(tick,1e3/fps)}function tick(){dt=myAnimate.slDT.value/100*3+.1,period<(tt+=dt*(isStep?2:1)*(isPlay?1:0))&&(tt-=period),isStep&&(isPlay=!1);for(var a=0;a<ballNN;a++){var e=a*dx,t=amplitude*Math.sin(2*Math.PI*e/lambda-2*Math.PI*tt/period),o=amplitude*Math.sin(2*Math.PI*e/lambda+2*Math.PI*tt/period),i=[t,o,.5*(t+o)];ballsD[a].y=i[waveMD-1];var c=ballsU[a];c.y=i[waveMD-1];t=-200*Math.cos(2*Math.PI*e/lambda-2*Math.PI*tt/period),o=200*Math.cos(2*Math.PI*e/lambda+2*Math.PI*tt/period),i=[t,o,.5*(t+o)];c.setArrow(1,0,i[waveMD-1]),c.arrowRotation1.scaleX=c.arrowRotation1.scaleY=2.5,c.arrowRotation1.visible=myAnimate.chVV.checked}for(a=0;a<ballNN-1;a++){var l=ballsD[a],r=ballsD[a+1],s=r.x-l.x,d=r.y-l.y,n=Math.sqrt(s*s+d*d),m=springsD[a];m.rotation=180*Math.atan2(d,s)/Math.PI,m.scaleX=n/100,m.scaleY=(65-n)/100,m.x=.5*(r.x+l.x),m.y=.5*(r.y+l.y);m=springsU[a];m.rotation=180*Math.atan2(d,s)/Math.PI,m.scaleX=n/100,m.scaleY=(64-n)/100,m.x=.5*(r.x+l.x),m.y=.5*(r.y+l.y),m.visible=myAnimate.chSpring.checked}if(springsD[ballNN-1].visible=springsU[ballNN-1].visible=!1,myAnimate.chEkUs.checked||myAnimate.chEtotal.checked){var h=coordEk.emp.shape.graphics,v=coordUs.emp.shape.graphics,b=coordEt.emp.shape.graphics;if(h.clear(),h.setStrokeStyle(8,"round").beginStroke("#FF0"),v.clear(),v.setStrokeStyle(8,"round").beginStroke("#0FF"),b.clear(),b.setStrokeStyle(8,"round").beginStroke("#FFF"),3===waveMD){var y=Math.cos(2*Math.PI*tt/period);h.moveTo(0,0),v.moveTo(0,-150*y*y),b.moveTo(0,-150*y*y);for(e=0;e<(ballNN-1)*dx;e+=1){var p=Math.sin(2*Math.PI*e/lambda)*Math.sin(2*Math.PI*tt/period),y=Math.cos(2*Math.PI*e/lambda)*Math.cos(2*Math.PI*tt/period);h.lineTo(e,-150*p*p),v.lineTo(e,-150*y*y),b.lineTo(e,-150*y*y-150*p*p)}}else{var k=Math.cos(-2*Math.PI*tt/period*(2===waveMD?-1:1));h.moveTo(0,-150*k*k),v.moveTo(0,-150*k*k),b.moveTo(0,-300*k*k);for(e=0;e<(ballNN-1)*dx;e+=1){k=Math.cos(2*Math.PI*e/lambda-2*Math.PI*tt/period*(2===waveMD?-1:1));h.lineTo(e,-150*k*k),v.lineTo(e,-150*k*k),b.lineTo(e,-300*k*k)}}}coordEk.visible=coordUs.visible=myAnimate.chEkUs.checked,coordEt.visible=myAnimate.chEtotal.checked,myAnimate.chEkUs.checked&&myAnimate.chEtotal.checked?(coordEk.y=133.4+.8*coordEk.y,coordUs.y=136.6+.8*coordUs.y):myAnimate.chEkUs.checked&&!myAnimate.chEtotal.checked&&(coordEk.y=110+.8*coordEk.y,coordUs.y=160+.8*coordUs.y),stage.update()}function clickRBWave(a){a=a.target.parent.name;myAnimate.rbWave01.checked=!1,myAnimate.rbWave02.checked=!1,myAnimate.rbWave03.checked=!1,"rbWave01"===a?(waveMD=1,myAnimate.rbWave01.checked=!0):"rbWave02"===a?(waveMD=2,myAnimate.rbWave02.checked=!0):"rbWave03"===a&&(waveMD=3,myAnimate.rbWave03.checked=!0)}function clickPlayStop(a){isStep=!1,isPlay=!isPlay}function clickStep(a){isPlay=isStep=!0}init(),MyJS.myResize();