'use strict';var app,gLine,imgNowDot,imgTopDot,bg1,bg2,boom,fps=60,log=console.log,nowDots=[],topDots=[],nnLines=60,theta0=60*Math.PI/180,tt=0,dt=.1,cameraX=0,cameraY=0,cameraScale=1;const gg=1.2,v0=25;var isPlay=!1;function init(){app=new PIXI.Application({view:canvasPixi[0],width:1600,height:900,antialias:!0,transparent:!0,resolution:1}),app.ticker.maxFPS=fps;let a=PIXI.Texture.from("allData/pics/bgPic2.png");bg2=new PIXI.Sprite(a),bg2.anchor.x=.5,bg2.anchor.y=.5,bg2.x=800,bg2.y=450,app.stage.addChild(bg2);let b=PIXI.Texture.from("allData/pics/bgPic1.png");bg1=new PIXI.Sprite(b),bg1.anchor.x=.5,bg1.anchor.y=.5,bg1.x=800,bg1.y=450,app.stage.addChild(bg1);let c=PIXI.Texture.from("allData/pics/boomPic.png");boom=new PIXI.Sprite(c),boom.anchor.x=.5,boom.anchor.y=.5,boom.x=800,boom.y=450,app.stage.addChild(boom),gLine=new PIXI.Graphics,app.stage.addChild(gLine);let d=PIXI.Texture.from("allData/pics/nowDot.png");for(let a,b=0;b<nnLines;b++)a=new PIXI.Sprite(d),a.anchor.x=.5,a.anchor.y=.5,a.x=400+20*b,a.y=400,nowDots.push(a),app.stage.addChild(a);let e=PIXI.Texture.from("allData/pics/topDot.png");for(let a,b=0;b<nnLines;b++)a=new PIXI.Sprite(e),a.anchor.x=.5,a.anchor.y=.5,a.x=400+20*b,a.y=400,topDots.push(a),app.stage.addChild(a);world2D.btnShoot.on("click",clickShoot),world2D.btnZero.on("click",clickZero),world2D.btnZero.visible=!1,world2D.slScale.minimum=30,world2D.slScale.maximum=120,world2D.slScale.value=80,world2D.slTheta0.value=33.3,setInterval(tick,1e3/fps)}function tick(){60>tt&&(tt+=isPlay?.1:0),cameraScale=.95*cameraScale+.05*world2D.slScale.value/100,cameraY=5*(world2D.slScale.value-100)/cameraScale,theta0=.9*theta0+.1*world2D.slTheta0.value/100*Math.PI,world2D.slTheta0.visible=world2D.chOnlyOne.checked,gLine.clear(),drawAllLines(0,tt),world2D.chSafeCurve.checked&&drawSafeLine(),drawAllNowDots(tt),drawAllTopDots(tt),world2D.chCircle.checked&&0<tt&&drawCircleLine(tt),bg1.scale.x=bg1.scale.y=2*cameraScale,bg1.y=450+cameraY*cameraScale,bg2.scale.x=bg2.scale.y=1.2*cameraScale,bg1.y=450+cameraY*cameraScale,boom.scale.x=boom.scale.y=.5*cameraScale,boom.y=450+cameraY*cameraScale,boom.visible=0===tt,world2D.equations.visible=world2D.chEquation.checked,world2D.equations.cross.y=cameraY*cameraScale,world2D.equations.gotoAndStop(world2D.chSafeCurve.checked?1:world2D.chEllipse.checked?2:world2D.chCircle.checked?3:0),world2D.stage.update()}MyJS.myResize();function clickShoot(){tt=0,isPlay=!0,world2D.btnZero.visible=!0,world2D.btnShoot.visible=!1}function clickZero(){tt=0,isPlay=!1,world2D.btnZero.visible=!1,world2D.btnShoot.visible=!0}function drawAllLines(a,b){for(var c=theta0;c<theta0+2*Math.PI*(world2D.chOnlyOne.checked?.001:1);c+=2*Math.PI/nnLines)drawOneLine(a,b,c)}function drawOneLine(a,b,c){gLine.lineStyle(world2D.chOnlyOne.checked?4:2,16737843,1);let d=Math.max(a,0),e=b,f=c,g=800+cameraScale*(cameraX+v0*Math.cos(f)*d),h=450+cameraScale*(cameraY-v0*Math.sin(f)*d+.5*gg*d*d);gLine.moveTo(g,h);let j=Math.floor(e-d);for(var k=0;k<=j+1;k++){let a=d+k;a>e&&(a=e),g=800+cameraScale*(cameraX+v0*Math.cos(f)*a),h=450+cameraScale*(cameraY-v0*Math.sin(f)*a+.5*gg*a*a),1020>h&&gLine.lineTo(g,h)}}function drawSafeLine(){gLine.lineStyle(6,26112,1);var a=-1e3/cameraScale;let b=450+cameraScale*(cameraY+.5*gg/v0/v0*a*a-v0*v0/2/gg);for(gLine.moveTo(a+800,b),a=-1e3;1e3>=a;a+=5){let c=a/cameraScale;b=450+cameraScale*(cameraY+.5*gg/v0/v0*c*c-v0*v0/2/gg),1020>b&&gLine.lineTo(a+800,b)}}function drawCircleLine(a){gLine.lineStyle(6,16711680,1);let b=.5*gg*a*a*cameraScale,c=v0*a*cameraScale;gLine.drawCircle(800,450+b+cameraY*cameraScale,c)}function drawAllNowDots(a){for(var b=0;b<(world2D.chOnlyOne.checked?1:nnLines);b++){let c=theta0+2*Math.PI*b/nnLines;drawOneNowDot(nowDots[b],a,c)}for(var b=1;b<nnLines;b++)nowDots[b].visible=!world2D.chOnlyOne.checked}function drawOneNowDot(a,b,c){let d,e=800+cameraScale*(cameraX+v0*Math.cos(c)*b),f=450+cameraScale*(cameraY-v0*Math.sin(c)*b+.5*gg*b*b);d=5>b?5*b:25+5*Math.sin(2*(b-5))*Math.exp(.05*-(b-5)),d*=.5+.5*cameraScale,a.x=e,a.y=f,a.scale.x=a.scale.y=d/256}function drawAllTopDots(a){for(var b=0;b<(world2D.chOnlyOne.checked?1:nnLines);b++){let c=theta0+2*Math.PI*b/nnLines;drawOneTopDot(topDots[b],c,a)}topDots[0].visible=topDots[0].visible&&world2D.chEllipse.checked;for(var b=1;b<nnLines;b++)topDots[b].visible=topDots[b].visible&&!world2D.chOnlyOne.checked&&world2D.chEllipse.checked}function drawOneTopDot(a,b,c){let d=800+cameraScale*(cameraX+v0*v0*Math.sin(2*b)/2/gg),e=450+cameraScale*(cameraY-v0*v0*Math.sin(b)*Math.sin(b)/2/gg),f=30*cameraScale;a.x=d,a.y=e,a.scale.x=a.scale.y=f/256,a.visible=c>Math.abs(v0*Math.sin(b)/gg)}init();