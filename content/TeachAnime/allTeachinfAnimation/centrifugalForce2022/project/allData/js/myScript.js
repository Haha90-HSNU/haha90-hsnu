"use strict";var conA,conB,conC,conD,cMD0,cMD1,viewerA0,viewerA1,objectA1,objectA2,arrA1fs,arrA1ff,arrA2ff,viewerB0,viewerB1,objectB1,objectB2,objectB3,arrB1fs,arrB1fc,arrB2fs,arrB2fc,viewerC0,viewerC1,objectC1,traceC1,arrC1fc,arrC1fco,arrC1v,arrC1w,viewerD0,viewerD1,viewerD2,viewerD3,objectD1,objectD2,objectD3,arrD1fs,arrD1ff,arrD1fc,arrD1fco,arrD2fs,arrD2ff,arrD2fc,arrD2fco,arrD3fs,arrD3ff,arrD3fc,arrD3fco,arrD3v,arrD3w,traceD3,dt,fps=60,log=console.log,courseMD="A",courseTweenRatio=0,arrR=1.2,arrL=5,isPlay=!0,isStep=!1,omegaA=.2,followRatioA=0,omegaB=.2,followRatioB=0,omegaC=.2,followRatioC=0,omegaD=.2,followRatioD1=0,followRatioD2=0,followRatioD3=0,tt=0,traceTime=0;function init(){initPlayers(),initControl(),world3D.cameraTarget.y=20,world2D.slCameraRR.value=120,setInterval(tick,1e3/fps)}function tick(){var o,e,t,r,i;tt<9&&3<tt&&(world2D.logo.scaleX=world2D.logo.scaleY=1.4*(9-tt)/6+.4*(tt-3)/6,world2D.logo.x=800*(9-tt)/6+250*(tt-3)/6,world2D.logo.y=450*(9-tt)/6+80*(tt-3)/6),dt=.1*world2D.slDT.value*(isPlay?1:0),tt+=dt,conA.visible="A"===courseMD,conB.visible="B"===courseMD,conC.visible="C"===courseMD,conD.visible="D"===courseMD,ground.visible=logo.visible=world2D.chGround.checked,"A"===courseMD||"A"===cMD1?(1<(followRatioA+=world2D.chFollow.checked?.01:-.01)?followRatioA=1:followRatioA<0&&(followRatioA=0),o=conA.RR*Math.sin(omegaA*tt),conA.box.position.x=15+o,conA.spring.setSpring(o+conA.L0,0,0),world3D.cameraTarget.x=followRatioA*o,arrA1fs.visible=world2D.chfs.checked,arrA1fs.position.y=.5,arrA1fs.scale.y=.5,arrA1fs.setArrow(-15*omegaA*omegaA*o,0,0),arrA2ff.visible=arrA1ff.visible=world2D.chff.checked,arrA1ff.position.y=2.5,arrA1ff.scale.y=.5,arrA1ff.setArrow(15*omegaA*omegaA*o*followRatioA,0,0),arrA2ff.position.y=2.5,arrA2ff.scale.y=.5,arrA2ff.setArrow(15*omegaA*omegaA*o*followRatioA,0,0)):"B"===courseMD||"B"===cMD1?(1<(followRatioB+=world2D.chFollow.checked?.01:-.01)?followRatioB=1:followRatioB<0&&(followRatioB=0),conB.rotator.rotation.y+=omegaB*dt,world3D.cameraPhi+=followRatioB*omegaB*dt,arrB1fs.visible=arrB2fs.visible=world2D.chfs.checked,arrB1fs.position.y=.5,arrB1fs.scale.y=.5,arrB1fs.setArrow(0,0,-15*omegaB*omegaB*objectB1.position.z),arrB1fc.visible=arrB2fc.visible=world2D.chfc.checked,arrB1fc.position.y=2.5,arrB1fc.scale.y=.5,arrB1fc.setArrow(0,0,15*omegaB*omegaB*objectB1.position.z*followRatioB),arrB2fs.position.y=.5,arrB2fs.scale.y=.5,arrB2fs.setArrow(0,0,-15*omegaB*omegaB*objectB2.position.z),arrB2fc.position.y=2.5,arrB2fc.scale.y=.5,arrB2fc.setArrow(0,0,15*omegaB*omegaB*objectB2.position.z*followRatioB)):"C"===courseMD||"C"===cMD1?(1<(followRatioC+=world2D.chFollow.checked?.01:-.01)?followRatioC=1:followRatioC<0&&(followRatioC=0),conC.rotator.rotation.y+=omegaC*dt,objectC1.position.x+=objectC1.vx*dt,37.5<objectC1.position.x&&0<objectC1.vx?(objectC1.position.x=37.5,objectC1.vx*=-1):objectC1.position.x<-37.5&&objectC1.vx<0&&(objectC1.position.x=-37.5,objectC1.vx*=-1),e=objectC1.position.x,t=conC.rotator.rotation.y,.3<tt-traceTime&&(traceTime=tt,traceC1.addPoint(e*Math.cos(t),0,e*Math.sin(t)),traceC1.update()),traceC1.line.position.x=e*Math.cos(t),traceC1.line.position.z=e*Math.sin(t),traceC1.visible=traceC1.line.visible=world2D.chTrace.checked,world3D.cameraPhi+=followRatioC*omegaC*dt,arrC1fc.visible=world2D.chfc.checked,arrC1fc.setArrow(objectC1.position.x*omegaC*omegaC*15*followRatioC,0,0),arrC1fc.position.y=2.5,arrC1fc.scale.y=.5,arrC1v.visible=world2D.chv.checked,arrC1v.position.y=2.5,arrC1w.position.y=2.5,arrC1w.visible=world2D.chw.checked,arrC1fco.visible=world2D.chfco.checked,arrC1fco.position.y=2.5,arrC1fco.scale.y=.5,r=objectC1.vx,i=objectC1.position.x*omegaC*followRatioC,arrC1v.setArrow(r,0,i),arrC1w.setArrow(0,10*followRatioC,0),arrC1fco.setArrow(-i*omegaC*followRatioC*15*2,0,r*omegaC*followRatioC*15*2)):"D"!==courseMD&&"D"!==cMD1||(followRatioD1+=world2D.chFollow.checked&&world2D.rbD1.checked?.01:-.01,followRatioD2+=world2D.chFollow.checked&&world2D.rbD2.checked?.01:-.01,followRatioD3+=world2D.chFollow.checked&&world2D.rbD3.checked?.01:-.01,1<followRatioD1?followRatioD1=1:followRatioD1<0&&(followRatioD1=0),1<followRatioD2?followRatioD2=1:followRatioD2<0&&(followRatioD2=0),1<followRatioD3?followRatioD3=1:followRatioD3<0&&(followRatioD3=0),viewerD1.scale.x=viewerD1.scale.y=viewerD1.scale.z=.1+.9*followRatioD1,viewerD2.scale.x=viewerD2.scale.y=viewerD2.scale.z=.1+.9*followRatioD2,viewerD3.scale.x=viewerD3.scale.y=viewerD3.scale.z=.1+.9*followRatioD3,world2D.pics.gotoAndStop(world2D.rbD1.checked?3:world2D.rbD2.checked?5:4),world2D.pics.scaleX=world2D.pics.scaleY=world2D.chFollow.checked?.8:0,conD.rotator.rotation.y+=omegaD*dt,viewerD1.rotation.y=-conD.rotator.rotation.y,world3D.cameraPhi+=(followRatioD2+followRatioD3)*omegaD*dt,world3D.cameraTarget.x=followRatioD1*viewerD1.position.x*Math.cos(-conD.rotator.rotation.y)+followRatioD2*viewerD2.position.z*Math.sin(conD.rotator.rotation.y),world3D.cameraTarget.z=followRatioD1*viewerD1.position.x*Math.sin(-conD.rotator.rotation.y)+followRatioD2*viewerD2.position.z*Math.cos(conD.rotator.rotation.y),arrD1fs.setArrow(0,0,-objectD1.position.z*omegaD*omegaD*15),arrD1fs.scale.y=.5,arrD1fs.position.y=.5,arrD1ff.setArrow(viewerD1.position.x*omegaD*omegaD*15*followRatioD1,0,viewerD2.position.z*omegaD*omegaD*15*followRatioD2),arrD1ff.position.y=2.5,arrD1ff.scale.y=.5,arrD1fc.setArrow(0,0,followRatioD3*objectD1.position.z*omegaD*omegaD*15),arrD1fc.position.y=2.5,arrD1fc.scale.y=.5,arrD1fco.visible=!1,arrD2fs.setArrow(0,0,-objectD2.position.z*omegaD*omegaD*15),arrD2fs.scale.y=.5,arrD2fs.position.y=.5,arrD2ff.setArrow(viewerD1.position.x*omegaD*omegaD*15*followRatioD1,0,viewerD2.position.z*omegaD*omegaD*15*followRatioD2),arrD2ff.position.y=2.5,arrD2ff.scale.y=.5,arrD2fc.setArrow(0,0,-(viewerD2.position.z-objectD2.position.z)*omegaD*omegaD*15*followRatioD2+objectD2.position.z*omegaD*omegaD*15*followRatioD3),arrD2fc.position.y=2.5,arrD2fc.scale.y=.5,arrD2fco.visible=!1,arrD3fs.visible=!1,arrD3ff.setArrow(viewerD1.position.x*omegaD*omegaD*15*followRatioD1*Math.cos(conD.rotator.rotation.y)+viewerD2.position.z*omegaD*omegaD*15*followRatioD2*Math.sin(conD.rotator.rotation.y),0,-viewerD1.position.x*omegaD*omegaD*15*followRatioD1*Math.sin(conD.rotator.rotation.y)+viewerD2.position.z*omegaD*omegaD*15*followRatioD2*Math.cos(conD.rotator.rotation.y)),arrD3ff.scale.y=.5,arrD3ff.position.y=2.5,e=viewerD2.position.z*Math.sin(conD.rotator.rotation.y)-objectD3.position.x,t=viewerD2.position.z*Math.cos(conD.rotator.rotation.y),arrD3fc.setArrow(followRatioD3*objectD3.position.x*omegaD*omegaD*15-followRatioD2*e*omegaD*omegaD*15,0,-followRatioD2*t*omegaD*omegaD*15),arrD3fc.scale.y=.5,arrD3fc.position.y=2.5,arrD3fco.setArrow(-(followRatioD2+followRatioD3)*objectD3.position.x*omegaD*2*omegaD*15,0,0),arrD3fco.scale.y=.5,arrD3fco.position.y=2.5,r=-followRatioD1*viewerD1.position.x*omegaD*Math.sin(conD.rotator.rotation.y),i=(followRatioD2+followRatioD3)*objectD3.position.x*omegaD-followRatioD1*viewerD1.position.x*omegaD*Math.cos(conD.rotator.rotation.y),arrD3v.setArrow(r,0,i),arrD3w.setArrow(0,10*(followRatioD2+followRatioD3),0),arrD3v.position.y=2.5,arrD3w.position.y=2.5,arrD1fs.visible=arrD2fs.visible=world2D.chfs.checked,arrD1ff.visible=arrD2ff.visible=arrD3ff.visible=world2D.chff.checked,arrD1fc.visible=arrD2fc.visible=arrD3fc.visible=world2D.chfc.checked,arrD3fco.visible=world2D.chfco.checked,arrD3v.visible=world2D.chv.checked,arrD3w.visible=world2D.chw.checked,.3<tt-traceTime&&(traceTime=tt,traceD3.addPoint(objectD3.position.x*Math.cos(conD.rotator.rotation.y),0,objectD3.position.x*Math.sin(conD.rotator.rotation.y)),traceD3.update()),traceD3.rotation.y=conD.rotator.rotation.y,traceD3.visible=traceD3.line.visible=world2D.chTrace.checked),"X"===courseMD&&(1<(courseTweenRatio+=.02)?(courseTweenRatio=1,courseMD=cMD1,this["con"+cMD0].scale.x=this["con"+cMD0].scale.y=this["con"+cMD0].scale.z=1,this["con"+cMD1].scale.x=this["con"+cMD1].scale.y=this["con"+cMD1].scale.z=1,ground.scale.x=ground.scale.z=1,world2D.pics.scaleX=world2D.pics.scaleY="D"===cMD1?0:1,this["con"+cMD1].visible=!0,world2D.btnPointer.x=world2D["btnGame"+cMD1].x,cMD1="X",world3D.cameraTarget.x=world3D.cameraTarget.z=0):(this["con"+cMD0].scale.x=this["con"+cMD0].scale.y=this["con"+cMD0].scale.z=courseTweenRatio<.5?(.5-courseTweenRatio)/.5:1e-9,this["con"+cMD1].scale.x=this["con"+cMD1].scale.y=this["con"+cMD1].scale.z=.5<courseTweenRatio?(courseTweenRatio-.5)/.5:1e-9,ground.scale.x=ground.scale.z=Math.max(this["con"+cMD0].scale.x,this["con"+cMD1].scale.x),world2D.pics.scaleX=world2D.pics.scaleY=0,this["con"+cMD0].visible=courseTweenRatio<.5,this["con"+cMD1].visible=.5<courseTweenRatio,world2D.btnPointer.x=world2D["btnGame"+cMD0].x*(1-courseTweenRatio)+world2D["btnGame"+cMD1].x*courseTweenRatio,world3D.cameraTarget.x*=.9,world3D.cameraTarget.z*=.9)),isStep&&(isPlay=!1),world3D.render(),world2D.stage.update()}function initPlayers(){var o=16751001,e=16776960,t=3407667,r=16738047,i=16763955,a=6711039;(conA=new THREE.Object3D).RR=20,conA.L0=40,scene.add(conA),conA.wall=new TEACHER.ObjBox(10,6,10,6710886),conA.wall.position.x=-conA.L0-5,conA.wall.position.y=3,conA.box=new TEACHER.ObjBox(30,6,10,6710886),conA.box.position.y=3,conA.spring=new TEACHER.ObjSpring(conA.L0,1.5,.2,18,16776960),conA.spring.position.x=-conA.L0,conA.spring.position.y=3,conA.spring.setSpring(conA.L0,0,0),conA.add(conA.wall).add(conA.box).add(conA.spring),(viewerA0=generateOneViewer(16751001)).position.y=0,viewerA0.position.x=-45,viewerA0.position.z=-45,conA.add(viewerA0),(viewerA1=generateOneViewer(16751001)).position.y=3,viewerA1.position.x=-10,conA.box.add(viewerA1),objectA1=generateOneObx(16777215),objectA2=generateOneObx(16777215),objectA1.position.x=5,objectA1.position.y=3,objectA2.position.z=20,objectA2.position.y=0,conA.box.add(objectA1),conA.add(objectA2),arrA1fs=new TEACHER.ObjArrow(arrR,o),arrA1ff=new TEACHER.ObjArrow(arrR,e),arrA2ff=new TEACHER.ObjArrow(arrR,e),objectA1.add(arrA1fs).add(arrA1ff),objectA2.add(arrA2ff),arrA1fs.visible=arrA1ff.visible=arrA2ff.visible=!1,(conB=new THREE.Object3D).RR=40,scene.add(conB),conB.rotator=new TEACHER.ObjPicCylinder(conB.RR,1,pics.ground2),conB.rotator.position.y=.5,(viewerB0=generateOneViewer(16751001)).position.y=0,viewerB0.position.x=-45,viewerB0.position.z=-45,(viewerB1=generateOneViewer(16751001)).position.y=.5,conB.add(conB.rotator),conB.rotator.add(viewerB1),conB.add(viewerB0),objectB1=generateOneObx(16777215),objectB2=generateOneObx(16777215),objectB1.position.y=objectB2.position.y=.5,objectB1.position.z=10,objectB2.position.z=30,conB.rotator.add(objectB1).add(objectB2),arrB1fs=new TEACHER.ObjArrow(arrR,o),arrB1fc=new TEACHER.ObjArrow(arrR,t),arrB2fs=new TEACHER.ObjArrow(arrR,o),arrB2fc=new TEACHER.ObjArrow(arrR,t),objectB1.add(arrB1fs).add(arrB1fc),objectB2.add(arrB2fs).add(arrB2fc),arrB1fc.visible=arrB1fs.visible=arrB2fc.visible=arrB2fs.visible=!1,(conC=new THREE.Object3D).RR=40,scene.add(conC),conC.rotator=new TEACHER.ObjPicCylinder(conB.RR,1,pics.ground2),conC.rotator.position.y=.5,(viewerC0=generateOneViewer(16751001)).position.y=0,viewerC0.position.x=-45,viewerC0.position.z=-45,(viewerC1=generateOneViewer(16751001)).position.y=.5,conC.add(conC.rotator),conC.rotator.add(viewerC1),conC.add(viewerC0);var n=new TEACHER.ObjBox(10,3,1,6710886),c=new TEACHER.ObjBox(10,3,1,6710886),s=new TEACHER.ObjBox(10,3,1,6710886),l=new TEACHER.ObjBox(10,3,1,6710886),w=new TEACHER.ObjBox(80,1,1,6710886),D=new TEACHER.ObjBox(80,1,1,6710886);n.position.x=45,n.position.z=-2,c.position.x=-45,c.position.z=-2,s.position.x=45,s.position.z=2,l.position.x=-45,l.position.z=2,w.position.z=2,D.position.z=-2,w.position.y=D.position.y=15.5,n.position.y=c.position.y=16.5,s.position.y=l.position.y=16.5,conC.add(w).add(c).add(n).add(l).add(s).add(D),(objectC1=generateOneObx(16777215)).position.y=16,conC.add(objectC1),objectC1.vx=5,(traceC1=new TEACHER.Points(16776960,1.5,80)).position.y=2,conC.rotator.add(traceC1),traceC1.line=new TEACHER.Line(16776960,1.5,2),traceC1.line.addPoint(0,2,0),traceC1.line.addPoint(0,18,0),traceC1.line.update(),conC.rotator.add(traceC1.line),arrC1fc=new TEACHER.ObjArrow(arrR,t),arrC1fco=new TEACHER.ObjArrow(arrR,r),arrC1v=new TEACHER.ObjArrow(arrR/2,i),arrC1w=new TEACHER.ObjArrow(arrR/2,a),objectC1.add(arrC1fc).add(arrC1fco).add(arrC1v).add(arrC1w),arrC1fc.visible=arrC1fco.visible=arrC1v.visible=arrC1w.visible=traceC1.visible=!1,(conD=new THREE.Object3D).RR=40,scene.add(conD),conD.rotator=new TEACHER.ObjPicCylinder(conD.RR,1,pics.ground2),conD.rotator.position.y=.5,(viewerD0=generateOneViewer(16751001)).position.x=-45,viewerD0.position.z=-45,viewerD1=generateOneViewer(16738047),viewerD2=generateOneViewer(3407667),viewerD3=generateOneViewer(16776960),viewerD1.position.y=viewerD3.position.y=.5,viewerD2.position.y=5.5,viewerD1.position.x=38,viewerD2.position.z=38,viewerD2.rotation.y=Math.PI,conD.add(conD.rotator),conD.rotator.add(viewerD1).add(viewerD2).add(viewerD3),conD.add(viewerD0),objectD1=generateOneObx(16777215),objectD2=generateOneObx(16777215),objectD3=generateOneObx(16777215),objectD1.position.y=objectD2.position.y=.5,objectD3.position.y=0,objectD1.position.z=37,objectD1.position.x=0,objectD2.position.z=-37,objectD3.position.x=-37,objectD3.position.y=20;s=new TEACHER.ObjBox(16,1,10,6710886),D=new TEACHER.ObjBox(1,20,6,6710886);s.position.x=-42,s.position.y=19.5,D.position.x=-49,D.position.y=10,conD.add(s).add(D),arrD1fs=new TEACHER.ObjArrow(arrR,o),arrD1ff=new TEACHER.ObjArrow(arrR,e),arrD1fc=new TEACHER.ObjArrow(arrR,t),arrD1fco=new TEACHER.ObjArrow(arrR,r),arrD2fs=new TEACHER.ObjArrow(arrR,o),arrD2ff=new TEACHER.ObjArrow(arrR,e),arrD2fc=new TEACHER.ObjArrow(arrR,t),arrD2fco=new TEACHER.ObjArrow(arrR,r),arrD3fs=new TEACHER.ObjArrow(arrR,o),arrD3ff=new TEACHER.ObjArrow(arrR,e),arrD3fc=new TEACHER.ObjArrow(arrR,t),arrD3fco=new TEACHER.ObjArrow(arrR,r),arrD3v=new TEACHER.ObjArrow(arrR/2,i),arrD3w=new TEACHER.ObjArrow(arrR/2,a),objectC1.add(arrC1fco).add(arrC1v).add(arrC1w),objectD1.add(arrD1fs).add(arrD1ff).add(arrD1fc).add(arrD1fco),objectD2.add(arrD2fs).add(arrD2ff).add(arrD2fc).add(arrD2fco),objectD3.add(arrD3fs).add(arrD3ff).add(arrD3fc).add(arrD3fco).add(arrD3v).add(arrD3w),conD.rotator.add(objectD1).add(objectD2),conD.add(objectD3),(traceD3=new TEACHER.Points(16776960,1.5,60)).position.y=1.5,traceD3.rotation.y=Math.PI,conD.add(traceD3),traceD3.line=new TEACHER.Line(16776960,1.5,2),traceD3.line.addPoint(objectD3.position.x,2,0),traceD3.line.addPoint(objectD3.position.x,18,0),traceD3.line.update(),conD.add(traceD3.line),arrD1fs.visible=arrD1ff.visible=arrD1fc.visible=arrD1fco.visible=!1,arrD2fs.visible=arrD2ff.visible=arrD2fc.visible=arrD2fco.visible=!1,arrD3fs.visible=arrD3ff.visible=arrD3fc.visible=arrD3fco.visible=arrD3v.visible=arrD3w.visible=!1,traceD3.visible=!1}function initControl(){world2D.chGround.checked=!0,world2D.chFollow.label.visible=!1,world2D.rbD1.label.visible=!1,world2D.rbD2.label.visible=!1,world2D.rbD3.label.visible=!1,world2D.chfs.label.visible=!1,world2D.chff.label.visible=!1,world2D.chfc.label.visible=!1,world2D.chfco.label.visible=!1,world2D.chv.label.visible=!1,world2D.chw.label.visible=!1,world2D.chTrace.label.visible=!1,world2D.slDT.minimum=0,world2D.slDT.maximum=1,world2D.slDT.value=1,world2D.slDT.digitN=1,world2D.slDT.setLabel("快慢"),world2D.btnGameA.on("click",clickGameMD),world2D.btnGameB.on("click",clickGameMD),world2D.btnGameC.on("click",clickGameMD),world2D.btnGameD.on("click",clickGameMD),world2D.rbD1.on("click",clickRBD123),world2D.rbD2.on("click",clickRBD123),world2D.rbD3.on("click",clickRBD123),world2D.rbD3.checked=!0,world2D.btnPlay.on("click",function(o){isPlay=isStep?!(isStep=!1):!isPlay}),world2D.btnStep.on("click",function(o){isPlay=isStep=!0}),setToCourse("A")}function clickGameMD(o){"X"!=courseMD&&(o=o.target.name,cMD1=o.charAt(7),(cMD0=courseMD)!==cMD1&&(courseTweenRatio=0,courseMD="X",setToCourse(cMD1)))}function setToCourse(o){world2D.chfs.visible=world2D.chff.visible=world2D.chfc.visible=world2D.chfco.visible=world2D.chv.visible=world2D.chw.visible=world2D.chTrace.visible=!1,world2D.rbD1.visible=world2D.rbD2.visible=world2D.rbD3.visible="D"===o,"A"===o?(world2D.chfs.visible=!0,world2D.chff.visible=!0,world2D.chFollow.checked=.5<followRatioA,world2D.chfs.checked=arrA1fs.visible,world2D.chff.checked=arrA2ff.visible,world2D.pics.gotoAndStop(0)):"B"===o?(world2D.chfs.visible=!0,world2D.chfc.visible=!0,world2D.chFollow.checked=.5<followRatioB,world2D.chfs.checked=arrB1fs.visible,world2D.chfc.checked=arrB1fc.visible,world2D.pics.gotoAndStop(1)):"C"===o?(world2D.chfc.visible=!0,world2D.chfco.visible=!0,world2D.chv.visible=!0,world2D.chw.visible=!0,world2D.chTrace.visible=!0,world2D.chFollow.checked=.5<followRatioC,world2D.chfc.checked=arrC1fc.visible,world2D.chfco.checked=arrC1fco.visible,world2D.chv.checked=arrC1v.visible,world2D.chw.checked=arrC1w.visible,world2D.chTrace.checked=traceC1.visible,world2D.pics.gotoAndStop(2)):"D"===o&&(world2D.chfs.visible=!0,world2D.chff.visible=!0,world2D.chfc.visible=!0,world2D.chfco.visible=!0,world2D.chv.visible=!0,world2D.chw.visible=!0,world2D.chTrace.visible=!0,world2D.chFollow.checked=.5<followRatioD1||.5<followRatioD2||.5<followRatioD3,world2D.chfs.checked=arrD1fs.visible,world2D.chff.checked=arrD3ff.visible,world2D.chfc.checked=arrD3fc.visible,world2D.chfco.checked=arrD3fco.visible,world2D.chv.checked=arrD3v.visible,world2D.chw.checked=arrD3w.visible,world2D.chTrace.checked=traceD3.visible,world2D.pics.gotoAndStop(4))}function clickRBD123(o){o=o.target.parent.name.charAt(3);world2D.rbD1.checked="1"===o,world2D.rbD2.checked="2"===o,world2D.rbD3.checked="3"===o}function generateOneViewer(o){var e=new THREE.Object3D;e.eyeH=10;var t=o||16737792,r=new TEACHER.ObjSphere(2,t);r.position.y=e.eyeH;var i=new TEACHER.ObjBox(4,4,1.6,t);i.position.y=e.eyeH-2-2;var a=new TEACHER.ObjCylinder(.4,e.eyeH-4-2,t),n=new TEACHER.ObjCylinder(.4,e.eyeH-4-2,t);n.position.y=a.position.y=.5*(e.eyeH-4-2),n.position.x=1,a.position.x=-1;var c=new TEACHER.ObjCylinder(.4,4,t),o=new TEACHER.ObjCylinder(.4,4,t);c.position.y=o.position.y=6,o.position.x=2.5,c.position.x=-2.5;t=new TEACHER.ObjSphere(.5,16711680);return t.position.y=e.eyeH,t.position.z=2.1,e.add(r).add(i).add(n).add(a).add(o).add(c).add(t),e}function generateOneObx(o){var e=new THREE.Object3D;e.LL=5,e.rr=.2;for(var o=o||16737792,t=new THREE.BoxGeometry(e.rr,e.rr,e.rr),r=new THREE.MeshBasicMaterial({color:o}),i=0;i<4;i++)(a=new THREE.Mesh(t,r)).scale.y=e.LL/e.rr,a.position.y=.5*e.LL,a.position.x=(i%2-.5)*(e.LL-e.rr),a.position.z=(Math.floor(i/2)-.5)*(e.LL-e.rr),e.add(a);for(i=0;i<4;i++)(a=new THREE.Mesh(t,r)).scale.x=e.LL/e.rr,a.position.y=(i%2-.5)*(e.LL-e.rr)+.5*e.LL,a.position.z=(Math.floor(i/2)-.5)*(e.LL-e.rr),e.add(a);for(var a,i=0;i<4;i++)(a=new THREE.Mesh(t,r)).scale.z=e.LL/e.rr,a.position.x=(i%2-.5)*(e.LL-e.rr),a.position.y=(Math.floor(i/2)-.5)*(e.LL-e.rr)+.5*e.LL,e.add(a);return e}MyJS.myResize();var TEACHER={ObjPlane:function(o,e,t,r,i){var a=this;a.mat=new TEACHER.MSMat(t,i),a.geo=new THREE.PlaneGeometry(o||10,e||10,1,1),a.mesh=new THREE.Mesh(a.geo,a.mat),"x"===r?a.mesh.rotation.y=.5*Math.PI:"y"===r&&(a.mesh.rotation.x=-.5*Math.PI),THREE.Object3D.call(this,a.geo,a.mat),a.add(a.mesh)}};TEACHER.ObjPlane.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjPlane.prototype.constructor=TEACHER.ObjPlane,TEACHER.ObjCylinder=function(o,e,t,r,i,a){var n=this;n.mat=new TEACHER.MSMat(t,a),n.geo=new THREE.CylinderGeometry(o||10,o||10,e||10,32,2,r),n.mesh=new THREE.Mesh(n.geo,n.mat),"x"===i?n.mesh.rotation.z=-.5*Math.PI:"z"===i&&(n.mesh.rotation.x=.5*Math.PI),THREE.Object3D.call(this,n.geo,n.mat),n.add(n.mesh)},TEACHER.ObjCylinder.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjCylinder.prototype.constructor=TEACHER.ObjCylinder,TEACHER.ObjSphere=function(o,e,t){var r=this;r.mat=new TEACHER.MSMat(e,t),r.geo=new THREE.SphereGeometry(o||10,32,16),r.mesh=new THREE.Mesh(r.geo,r.mat),THREE.Object3D.call(this,r.geo,r.mat),r.add(r.mesh)},TEACHER.ObjSphere.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjSphere.prototype.constructor=TEACHER.ObjSphere,TEACHER.ObjBox=function(o,e,t,r,i){var a=this;a.mat=new TEACHER.MSMat(r,i),a.geo=new THREE.BoxGeometry(o||10,e||10,t||10),a.mesh=new THREE.Mesh(a.geo,a.mat),THREE.Object3D.call(this,a.geo,a.mat),a.add(a.mesh)},TEACHER.ObjBox.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjBox.prototype.constructor=TEACHER.ObjBox,TEACHER.MSMat=function(o,e){THREE.MeshStandardMaterial.call(this,{color:o||16711935,roughness:.4,side:e||0})},TEACHER.MSMat.prototype=Object.create(THREE.MeshStandardMaterial.prototype),TEACHER.MSMat.prototype.constructor=TEACHER.MSMat,TEACHER.ObjPicPlane=function(o,e,t,r,i){var a=this,t=(new THREE.TextureLoader).load(t);a.mat=new THREE.MeshBasicMaterial({map:t,transparent:!0,side:i||0}),a.geo=new THREE.PlaneGeometry(o,e,1,1),a.mesh=new THREE.Mesh(a.geo,a.mat),"x"===r?a.mesh.rotation.y=.5*Math.PI:"y"===r&&(a.mesh.rotation.x=-.5*Math.PI),THREE.Object3D.call(this),a.add(a.mesh)},TEACHER.ObjPicPlane.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjPicPlane.prototype.constructor=TEACHER.ObjPicPlane,TEACHER.ObjPicCylinder=function(o,e,t,r,i,a){var n=this,t=(new THREE.TextureLoader).load(t);n.mat=new THREE.MeshBasicMaterial({map:t,side:a||0}),n.geo=new THREE.CylinderGeometry(o||10,o||10,e||10,32,4,r),n.mesh=new THREE.Mesh(n.geo,n.mat),"x"===i?n.mesh.rotation.z=-.5*Math.PI:"z"===i?(n.mesh.rotation.y=.5*Math.PI,n.mesh.rotation.x=.5*Math.PI):"y"===i&&(n.mesh.rotation.y=.5*Math.PI),THREE.Object3D.call(this,n.geo,n.mat),n.add(n.mesh)},TEACHER.ObjPicCylinder.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjPicCylinder.prototype.constructor=TEACHER.ObjPicCylinder,TEACHER.ObjPicSphere=function(o,e,t){var r=this,e=(new THREE.TextureLoader).load(e);r.mat=new THREE.MeshBasicMaterial({map:e,side:t||0}),r.geo=new THREE.SphereGeometry(o||10,32,16),r.mesh=new THREE.Mesh(r.geo,r.mat),THREE.Object3D.call(this,r.geo,r.mat),r.add(r.mesh)},TEACHER.ObjPicSphere.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjPicSphere.prototype.constructor=TEACHER.ObjPicSphere,TEACHER.ObjArrow=function(o,e){var t=new THREE.MeshStandardMaterial({color:e||16711935,roughness:.4}),e=new THREE.ConeGeometry(o||10,40,32);this.ArrowHead=new THREE.Mesh(e,t),this.ArrowHead.position.y=80,e=new THREE.CylinderGeometry(.5*(o||10),.5*(o||10),60,32,2),this.ArrowBody=new THREE.Mesh(e,t),this.ArrowBody.position.y=30,THREE.Object3D.call(this),this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.ArrowBody),this.rotX.add(this.ArrowHead)},TEACHER.ObjArrow.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjArrow.prototype.constructor=TEACHER.ObjArrow,TEACHER.ObjArrow.prototype.setArrow=function(o,e,t){var r=o*o+e*e+t*t,i=Math.sqrt(r);0<r?(this.rotX.visible=!0,this.rotX.scale.y=i/100):this.rotX.visible=!1,this.rotX.rotation.x=Math.acos(e/i),this.rotY.rotation.y=Math.atan2(o,t)},TEACHER.ObjSpring=function(o,e,t,r,i){var a=o||20;this.L0=a;let n=[];var c=r||5,s=e||5,e=t||.5;n.push(new THREE.Vector3(0,0,0)),n.push(new THREE.Vector3(0,.05*a,0));for(var l=0;l<=16*c;l++)n.push(new THREE.Vector3(s*Math.cos(2*l*Math.PI/16),a*(.05+.9*l/c/16),s*Math.sin(2*l*Math.PI/16)));n.push(new THREE.Vector3(0,.95*a,0)),n.push(new THREE.Vector3(0,a,0));t=new THREE.CatmullRomCurve3(n),i=new THREE.MeshStandardMaterial({color:i||16711935,roughness:.4}),e=new THREE.TubeGeometry(t,500,e,12);this.mesh=new THREE.Mesh(e,i),THREE.Object3D.call(this),this.rotX=new THREE.Object3D,this.rotY=new THREE.Object3D,this.add(this.rotY),this.rotY.add(this.rotX),this.rotX.add(this.mesh)},TEACHER.ObjSpring.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjSpring.prototype.constructor=TEACHER.ObjSpring,TEACHER.ObjSpring.prototype.setSpring=function(o,e,t){var r=o*o+e*e+t*t,i=Math.sqrt(r);0<r?(this.rotX.visible=!0,this.rotX.scale.y=i/this.L0):this.rotX.visible=!1,this.rotX.rotation.x=Math.acos(e/i),this.rotY.rotation.y=Math.atan2(o,t)},TEACHER.Points=function(o,e,t){var r=this,e=e||1,o=o||16711935;let i=new THREE.Color(o);r.nnMax=t||1e4,r.nnNow=0,r.geometry=new THREE.BufferGeometry,r.positions=[],r.geometry.setAttribute("position",new THREE.Float32BufferAttribute(r.positions,3)),r.geometry.computeBoundingSphere();e=new THREE.PointsMaterial({size:e,map:r.createCanvasMaterial("#"+i.getHexString(),64),transparent:!0,depthWrite:!1});THREE.Points.call(this,r.geometry,e)},TEACHER.Points.prototype=Object.create(THREE.Points.prototype),TEACHER.Points.prototype.constructor=TEACHER.Points,TEACHER.Points.prototype.createCanvasMaterial=function(o,e){var t=document.createElement("canvas");t.width=t.height=e;var r=t.getContext("2d");r.imageSmoothingEnabled=!1;var i=new THREE.Texture(t),t=e/2;return r.beginPath(),r.arc(t,t,e/2-3,0,2*Math.PI,!1),r.closePath(),r.fillStyle=o,r.fill(),i.needsUpdate=!0,i},TEACHER.Points.prototype.addPoint=function(o,e,t){var r=this;r.nnNow<r.nnMax?r.nnNow++:(r.positions.shift(),r.positions.shift(),r.positions.shift()),r.positions.push(o,e,t)},TEACHER.Points.prototype.clear=function(){this.positions=[],this.nnNow=0,this.update()},TEACHER.Points.prototype.setPoint=function(o,e,t,r){var i=this;o>i.nnMax?log("輸入的n值大於TEACHER.Points 最大點數 nnMax"):o>i.nnNow?log("輸入的n值大於TEACHER.Points 現在點數 nnNow"):(i.positions[3*o]=e,i.positions[3*o+1]=t,i.positions[3*o+2]=r)},TEACHER.Points.prototype.getPoint=function(o){var e=this;let t=new THREE.Vector3;return o>e.nnMax?log("輸入的n值大於TEACHER.Points 最大點數 nnMax"):o>e.nnNow?log("輸入的n值大於TEACHER.Points 現在點數 nnNow"):(t.x=e.positions[3*o],t.y=e.positions[3*o+1],t.z=e.positions[3*o+2]),t},TEACHER.Points.prototype.update=function(){this.geometry.setAttribute("position",new THREE.Float32BufferAttribute(this.positions,3)),this.geometry.computeBoundingSphere(),this.geometry.attributes.position.needsUpdate=!0},TEACHER.Line=function(o,e,t){var r=this;r.nnMax=t||1e4,r.lineWidth=e||1,r.nnNow=0;e=new THREE.LineMaterial({color:o||16711935,linewidth:e||1});e.resolution.set(window.innerWidth,window.innerHeight),r.geometry=new THREE.LineGeometry,r.positions=new Float32Array(3*r.nnMax),r.geometry.setPositions(r.positions),THREE.Line2.call(this,r.geometry,e)},TEACHER.Line.prototype=Object.create(THREE.Line2.prototype),TEACHER.Line.prototype.constructor=TEACHER.Line,TEACHER.Line.prototype.addPoint=function(o,e,t){var r=this;if(r.nnNow<r.nnMax)r.nnNow++;else for(var i=0;i<r.nnMax-1;i++)r.positions[3*i]=r.positions[3*i+3],r.positions[3*i+1]=r.positions[3*i+4],r.positions[3*i+2]=r.positions[3*i+5];for(i=r.nnNow;i<=r.nnMax;i++)r.positions[3*(i-1)]=o,r.positions[3*(i-1)+1]=e,r.positions[3*(i-1)+2]=t},TEACHER.Line.prototype.clear=function(){this.positions=new Float32Array(3*this.nnMax),this.nnNow=0,this.update()},TEACHER.Line.prototype.setPoint=function(o,e,t,r){var i=this;o>i.nnMax?log("輸入的n值大於TEACHER.Line 最大點數 nnMax"):o>i.nnNow?log("輸入的n值大於TEACHER.Line 現在點數 nnNow"):(i.positions[3*o]=e,i.positions[3*o+1]=t,i.positions[3*o+2]=r)},TEACHER.Line.prototype.getPoint=function(o){var e=this;let t=new THREE.Vector3;return o>e.nnMax?log("輸入的n值大於TEACHER.Line 最大點數 nnMax"):o>e.nnNow?log("輸入的n值大於TEACHER.Line 現在點數 nnNow"):(t.x=e.positions[3*o],t.y=e.positions[3*o+1],t.z=e.positions[3*o+2]),t},TEACHER.Line.prototype.update=function(){for(var o=this,e=o.getPoint(o.nnNow-1),t=o.nnNow;t<=o.nnMax;t++)o.positions[3*t]=e.x,o.positions[3*t+1]=e.y,o.positions[3*t+2]=e.z;o.geometry.setPositions(o.positions)},TEACHER.ObjTextPlane=function(o,e,t,r,i,a){var n=this,c=Math.round(Math.log2(o/e)),s=$("<canvas>").attr("width",String(128*Math.pow(2,c))).attr("height","128");n.stage=new createjs.Stage(s[0]);let l=new createjs.Container;if(a){let o=new createjs.Shape,e=new THREE.Color(a);o.graphics.c().f("#"+e.getHexString()).dr(0,0,128*Math.pow(2,c),128),l.addChild(o)}n.ctext=new createjs.Text;let w=new THREE.Color(i||16777215);n.ctext.color="#"+w.getHexString(),n.ctext.font="96px Arial",n.ctext.text=t||"",n.ctext.textAlign="center",n.ctext.textBaseline="middle",n.ctext.x=128*Math.pow(2,c)/2,n.ctext.y=64,l.addChild(n.ctext),n.stage.addChild(l),n.stage.update(),n.texture=new THREE.Texture(s[0]);s=new THREE.MeshBasicMaterial({map:n.texture,transparent:!0}),e=new THREE.PlaneGeometry(o||10,e||10,1,1);n.texture.needsUpdate=!0,n.plane1=new THREE.Mesh(e,s),n.plane2=new THREE.Mesh(e,s),n.plane2.rotation.y=Math.PI;let D=new THREE.Object3D;D.add(n.plane1).add(n.plane2),"x"===r?D.rotation.y=.5*Math.PI:"y"===r&&(D.rotation.x=-.5*Math.PI),THREE.Object3D.call(this),n.add(D)},TEACHER.ObjTextPlane.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjTextPlane.prototype.constructor=TEACHER.ObjTextPlane,TEACHER.ObjTextPlane.prototype.setText=function(o){this.ctext.text=o,this.stage.update(),this.texture.needsUpdate=!0},TEACHER.ObjGraph=function(o,e,t,r,i,a,n){var c=this;c.objCon=new THREE.Object3D,c._xMin=o||0,c._xMax=e||10,c._yMin=t||0,c._yMax=r||10,c.divXN=5,c.divYN=4,c.frameMat=new THREE.LineBasicMaterial({color:i||16777215});for(var s=[],l=0;l<=c.divXN;l++)s.push(new THREE.Vector3(20*l-50,0,0)),s.push(new THREE.Vector3(20*l-50,50,0));for(var w=0;w<=c.divYN;w++)s.push(new THREE.Vector3(-50,12.5*w,0)),s.push(new THREE.Vector3(50,12.5*w,0));r=(new THREE.BufferGeometry).setFromPoints(s);c.frame=new THREE.LineSegments(r,c.frameMat),c.objCon.add(c.frame),c.labelXMin=new TEACHER.ObjTextPlane(20,5,String(c._xMin),"z",i||16777215),c.labelXMin.position.x=-50,c.labelXMin.position.y=-3,c.objCon.add(c.labelXMin),c.labelXMax=new TEACHER.ObjTextPlane(20,5,String(c._xMax),"z",i||16777215),c.labelXMax.position.x=50,c.labelXMax.position.y=-3,c.objCon.add(c.labelXMax),c.labelYMin=new TEACHER.ObjTextPlane(20,5,String(c._yMin),"z",i||16777215),c.labelYMin.position.x=-53,c.labelYMin.position.y=0,c.objCon.add(c.labelYMin),c.labelYMax=new TEACHER.ObjTextPlane(20,5,String(c._yMax),"z",i||16777215),c.labelYMax.position.x=-53,c.labelYMax.position.y=50,c.objCon.add(c.labelYMax),c.labelX=new TEACHER.ObjTextPlane(24,7,"x","z",i||16777215),c.labelX.position.x=60,c.labelX.position.y=4,c.labelX.position.z=1,c.labelY=new TEACHER.ObjTextPlane(24,7,"y","z",i||16777215),c.labelY.position.x=-60,c.labelY.position.y=25,c.labelY.position.z=1,c.labelY.rotation.z=Math.PI/2,c.labelTitle=new TEACHER.ObjTextPlane(40,10,"y-x","z",i||16777215),c.labelTitle.position.y=53,c.labelTitle.position.z=1,c.objCon.add(c.labelX).add(c.labelY).add(c.labelTitle),c._lineColor=a,c._nnMax=n,c.line=new TEACHER.Line(c._lineColor||16776960,2,c._nnMax),c.objCon.add(c.line),c.changeScale(),THREE.Object3D.call(this),c.add(c.objCon)},TEACHER.ObjGraph.prototype=Object.create(THREE.Object3D.prototype),TEACHER.ObjGraph.prototype.constructor=TEACHER.ObjGraph,Object.defineProperty(TEACHER.ObjGraph.prototype,"xMin",{get:function(){return this._xMin},set:function(o){this._xMin=o,this.changeScale()}}),Object.defineProperty(TEACHER.ObjGraph.prototype,"xMax",{get:function(){return this._xMax},set:function(o){this._xMax=o,this.changeScale()}}),Object.defineProperty(TEACHER.ObjGraph.prototype,"yMin",{get:function(){return this._yMin},set:function(o){this._yMin=o,this.changeScale()}}),Object.defineProperty(TEACHER.ObjGraph.prototype,"yMax",{get:function(){return this._yMax},set:function(o){this._yMax=o,this.changeScale()}}),TEACHER.ObjGraph.prototype.addPoint=function(o,e){this.line.addPoint(o,e,0),this.line.update()},TEACHER.ObjGraph.prototype.clear=function(){this.line.clear()},TEACHER.ObjGraph.prototype.changeScale=function(){var o=this;o.line.scale.x=100/(o._xMax-o._xMin),o.line.scale.y=50/(o._yMax-o._yMin),o.line.position.x=-50-o._xMin*o.line.scale.x,o.line.position.y=-o._yMin*o.line.scale.y,o.labelXMin.setText(o._xMin),o.labelXMax.setText(o._xMax),o.labelYMin.setText(o._yMin),o.labelYMax.setText(o._yMax)},TEACHER.ObjGraph.prototype.setLabel=function(o,e,t){this.labelTitle.setText(o||"y-x"),this.labelY.setText(e||"y"),this.labelX.setText(t||"x")};var skyBox=new THREE.Object3D;skyBox.wallU=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallU,"y",1),skyBox.wallD=new TEACHER.ObjPicPlane(1e4,1e4,pics.wallD,"y",0),skyBox.wallS=new TEACHER.ObjPicCylinder(5e3,1e4,pics.wallSide,!0,"y",1),skyBox.wallU.position.y=5e3,skyBox.wallD.position.y=-5e3,skyBox.add(skyBox.wallU).add(skyBox.wallD).add(skyBox.wallS),world3D.scene.add(skyBox);var ground=new TEACHER.ObjPicPlane(100,100,pics.ground,"y");world3D.scene.add(ground);var logo=new TEACHER.ObjPicPlane(100,12.5,pics.logo,"z",2);function getMouse3D(o,e){var t=o||"y";let r;o=new THREE.Vector3;"x"===t?r=new THREE.Vector3(1,0,0):"y"===t?r=new THREE.Vector3(0,1,0):"z"===t?r=new THREE.Vector3(0,0,1):log("錯誤!!");let i=new THREE.Vector2;return i.x=world2D.stage.mouseX/1600*2-1,i.y=-world2D.stage.mouseY/900*2+1,world3D.raycaster.setFromCamera(i,world3D.camera),world3D.raycaster.ray.intersectPlane(new THREE.Plane(r),o),o}logo.position.z=-50,logo.position.y=6.25,world3D.scene.add(logo),init();